<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="rep_intro.css" type="text/css" charset="UTF-8"?>
<XML>
<TITLE> </TITLE><Heading-1>
<A ID="pgfId-1068234"></A>
<A ID="71050"></A>
Flexible Replication in MarkLogic Server</Heading-1>
<pagenum>
<A ID="pgfId-1068238"></A>
9</pagenum>
<Body>
<A ID="pgfId-1066500"></A>
This chapter describes Flexible Replication in MarkLogic Server in general terms, and includes the following sections:</Body>
<Body-bullet>
<A ID="pgfId-1066504"></A>
<A href="rep_intro.xml#id(94481)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Terms Used in this Guide</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1067636"></A>
<A href="rep_intro.xml#id(62963)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Understanding Flexible Replication</Hyperlink>
</A></Body-bullet>
<Note>
<A ID="pgfId-1068345"></A>
To enable Flexible Replication, a license key that includes Flexible Replication is required. For details on purchasing a Flexible Replication license, contact your MarkLogic sales representative.</Note>
<Heading-2>
<A ID="pgfId-1067584"></A>
<A ID="94481"></A>
Terms Used in this Guide</Heading-2>
<Body>
<A ID="pgfId-1067585"></A>
The following are the definitions for the replication terms used in this guide: </Body>
<Body-bullet>
<A ID="pgfId-1067586"></A>
To <Emphasis>
Replicate</Emphasis>
 is to create a copy of a document in another database and to keep that copy in sync (possibly with some time-lag/latency) with the original.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1067588"></A>
The <Emphasis>
Master</Emphasis>
 is the repository that gets updated by the applications. The master, in turn, replicates the updates to other repositories, know as replicas. </Body-bullet>
<Body-bullet>
<A ID="pgfId-1067589"></A>
A <Emphasis>
Replica </Emphasis>
is a repository that receives replicated updates from the master.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1067590"></A>
A <Emphasis>
Master Copy</Emphasis>
 is the content being replicated. For any piece of replicated content there is a master and at least one copy. </Body-bullet>
<Body-bullet>
<A ID="pgfId-1067591"></A>
A <Emphasis>
Master Cluster</Emphasis>
 is the cluster on which the replicated documents are updated by the applications.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1067595"></A>
<Emphasis>
Flexible Replication</Emphasis>
 is an implementation of replication based on the MarkLogic Server Content Processing Framework (CPF). Flexible replication is single-master, asynchronous, and provides a medium level of throughput and latency. </Body-bullet>
<Body-bullet>
<A ID="pgfId-1067597"></A>
<Emphasis>
Replication Domain</Emphasis>
 is the specification of the set of documents to be replicated. This may be a collection or some other set definition.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1067598"></A>
A <Emphasis>
Filter</Emphasis>
 is an XQuery program that modifies the replicated documents in some manner, determines whether to replicate a change, or selects which parts of a document will be replicated. </Body-bullet>
<Body-bullet>
<A ID="pgfId-1067599"></A>
<Emphasis>
Asynchronous Replication</Emphasis>
 refers to a configuration in which the Master does not wait for confirmation that the update has been received by the Replica before sending further updates. Flexible Replication is asynchronous.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1067600"></A>
<Emphasis>
Transaction-aware</Emphasis>
 refers to a configuration in which all updates that make up a transaction on the master are applied as a single transaction on the replica.</Body-bullet>
<Heading-2>
<A ID="pgfId-1066315"></A>
<A ID="62963"></A>
Understanding Flexible Replication</Heading-2>
<Body>
<A ID="pgfId-1066532"></A>
Flexible Replication is the process of maintaining copies of data on multiple MarkLogic Servers. The purpose of replication is to make data continuously available to mission-critical applications and to enhance application performance. Some of the benefits of replication include:</Body>
<Body-bullet>
<A ID="pgfId-1066537"></A>
High Availability: You can maintain duplicate data on two or more MarkLogic Servers. In the event of a software or hardware failure on one server, the data is available from another server.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1067901"></A>
Disaster Recovery: In the event of some irreversible disaster on the Master server, duplicate data is preserved on its Replica.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1066538"></A>
Performance: Companies with geographically dispersed clusters can use replication to maintain common data on each local cluster. Queries and updates done locally, are faster and the workload can be scaled across clusters, so that each cluster handles less of the query and update load.</Body-bullet>
<Body>
<A ID="pgfId-1066363"></A>
In a replicated environment, the original content is created by an application on the Master MarkLogic Server. Replication then copies the content to one or more Replica MarkLogic Servers. The Master and Replica servers are typically in different clusters, which may be in the same location or in different locations.</Body>
<Body-indent>
<A ID="pgfId-1066091"></A>
<IMAGE xml:link="simple" href="rep_intro-1.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body>
<A ID="pgfId-1066469"></A>
Flexible Replication is asynchronous, which means that the Master does not wait for confirmation that the update has been received by the Replica before sending further updates. Replication from the Master to the Replica occurs as soon as possible after the document is added or updated by the application.</Body>
<Body>
<A ID="pgfId-1066627"></A>
MarkLogic Server uses the Content Processing Framework (CPF) as the underlying replication mechanism. The documents to be replicated are defined by a CPF domain. The scope of a domain may be a document, a collection of documents, or a directory. For more details about domains, see <A href="../cpf/domains.xml#id(11600)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Understanding and Using Domains</Hyperlink>
</A> in the <Emphasis>
Content Processing Framework Guide</Emphasis>
 Guide. You can replicate multiple domains either to the same Replica or to different Replicas, as shown is the illustrations below.</Body>
<Body-indent>
<A ID="pgfId-1066756"></A>
<IMAGE xml:link="simple" href="rep_intro-2.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body-indent>
<A ID="pgfId-1066837"></A>
<IMAGE xml:link="simple" href="rep_intro-3.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body>
<A ID="pgfId-1066634"></A>
Replicated databases do not necessarily need to be configured as entirely a Master or a Replica in the replication scheme. For example, you may have two databases, DB1 and DB2, where DB1 replicates updates to the documents in Domain A to DB2 and DB2 replicates updates to the documents in Domain B to DB1. </Body>
<Note>
<A ID="pgfId-1067443"></A>
This is not a multi-master replication configuration, as the documents updated by each application must be in different domains. Any overlap between the replicated domains may result in unpredictable behavior.</Note>
<Body-indent>
<A ID="pgfId-1067498"></A>
<IMAGE xml:link="simple" href="rep_intro-4.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body>
<A ID="pgfId-1067684"></A>
Another possible Master/Replica configuration is where a Master replicates updates to a Replica/Master that replicates the updates to another Replica. For example, you may have three databases, DB1, DB2, and DB3, where DB1 replicates updates to DB2 and DB2 replicates updates to DB3.</Body>
<Body-indent>
<A ID="pgfId-1067765"></A>
<IMAGE xml:link="simple" href="rep_intro-5.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body>
<A ID="pgfId-1067132"></A>
You can set up filters that narrow the scope of what documents and what parts of the documents are replicated within a domain. For example, you can set up a filter to replicate only XML documents, or you can create filters to only replicate inserts and updates (not deletes), or only replicate a particular node or element within each document.</Body>
<Body>
<A ID="pgfId-1067023"></A>
Replication can be configured to either <Emphasis>
push</Emphasis>
 or <Emphasis>
pull </Emphasis>
updates<Emphasis>
 </Emphasis>
from the Master to the Replica. Push replication means that the Master pushes updates to the Replica. Pull replication means the Replica pulls updates from the Master. Push replication is triggered whenever an update is made on the Master database. Pull replication can only be configured as a scheduled task, as described in <A href="configuring.xml#id(37645)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Configuring Pull Replication' on page&#160;35</A>. Typically, you should use push replication, unless the Master and Replica are separated by a firewall through which a Replica server can only pull content from a Master server outside the firewall.</Body>
</XML>
