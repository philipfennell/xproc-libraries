<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="configuring.css" type="text/css" charset="UTF-8"?>
<XML>
<TITLE> </TITLE><Heading-1>
<A ID="pgfId-1065677"></A>
Configuring Replication</Heading-1>
<pagenum>
<A ID="pgfId-1066136"></A>
38</pagenum>
<Body>
<A ID="pgfId-1066120"></A>
This chapter describes how to configure your MarkLogic Servers for replication. The topics in this chapter assume you are familiar with the replication principles described in <A href="rep_intro.xml#id(62963)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Understanding Flexible Replication' on page&#160;6</A> and the basic configuration procedures described in the <A href="quick_start.xml#id(12943)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Flexible Replication Quick Start' on page&#160;10</A>.</Body>
<Body>
<A ID="pgfId-1067138"></A>
This chapter includes the following sections:</Body>
<Body-bullet>
<A ID="pgfId-1067220"></A>
<A href="configuring.xml#id(22183)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Replication Security</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1066159"></A>
<A href="configuring.xml#id(44393)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Defining Replicated Domains</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1067038"></A>
<A href="configuring.xml#id(70719)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Configuring Replication App Servers</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1066975"></A>
<A href="configuring.xml#id(23790)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Configuring Push Replication</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1067907"></A>
<A href="configuring.xml#id(91720)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Creating a Scheduled Replication Task</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1070861"></A>
<A href="configuring.xml#id(37645)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Configuring Pull Replication</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1070516"></A>
<A href="configuring.xml#id(85704)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Clearing the Master and Replica Databases</Hyperlink>
</A></Body-bullet>
<Heading-2>
<A ID="pgfId-1067198"></A>
<A ID="22183"></A>
Replication Security</Heading-2>
<Body>
<A ID="pgfId-1067464"></A>
The <code>
flexrep-admin</code>
 role is required to configure replication. The user you use to access the Replica App Server when pushing, or into the Master App Server when pulling, requires the <code>
flexrep-user</code>
 role. Though you will typically configure replication as the Admin user, you should create a unique replication user to be associated with the replication tasks. The replication user must be given the <code>
flexrep-user</code>
 role and have the privileges necessary to update the domain content. </Body>
<Body>
<A ID="pgfId-1067290"></A>
You can configure SSL on your Master and Replica App Servers to encrypt the replicated data passed between them. For details on configuring SSL on App Server, see the <A href="../admin/SSL.xml#id(85783)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Configuring SSL on App Servers</Hyperlink>
</A> chapter in the <Emphasis>
Administrator's Guide</Emphasis>
.</Body>
<Body>
<A ID="pgfId-1068719"></A>
If SSL on the Replica App Server is configured to require a client certificate from the Master, the Target URL must start with HTTPS. Paste the PEM-encoded client certificate and client key in the fields located at the bottom of the Database Replication Target Administration page. If the client key is encrypted, you must also specify a pass phase. </Body>
<Body>
<A ID="pgfId-1068802"></A>
The same security configuration applies when configuring the Replica App Server for pull replication, if the Master App Server requires a client certificate from the Replica. For details on how to configure pull replication, see <A href="configuring.xml#id(23393)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Creating a Pull Replication Task' on page&#160;34</A></Body>
<Body-indent>
<A ID="pgfId-1068723"></A>
<IMAGE xml:link="simple" href="images/https-target-URL.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body-indent>
<A ID="pgfId-1068724"></A>
</Body-indent>
<Body-indent>
<A ID="pgfId-1067013"></A>
<IMAGE xml:link="simple" href="images/pull-config-cert.gif" show="embed" actuate="auto"/>
</Body-indent>
<Heading-2>
<A ID="pgfId-1066977"></A>
<A ID="44393"></A>
Defining Replicated Domains</Heading-2>
<Body>
<A ID="pgfId-1067020"></A>
Before you can define replicated domains, you must enable CPF as described in <A href="quick_start.xml#id(58017)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Configuring a Flexible Replication Pipeline for the Master Database' on page&#160;11</A>.</Body>
<Body>
<A ID="pgfId-1066983"></A>
CPF domains are described in detail in the <A href="../cpf/domains.xml#id(11600)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Understanding and Using Domains</Hyperlink>
</A> chapter in the <Emphasis>
Content Processing Framework Guide</Emphasis>
 Guide. The purpose of this section is to describe how to create a domain that defines the scope of the documents in the Master database to be replicated to the Replica database. </Body>
<WarningList>
<Warning>
<A ID="pgfId-1068685"></A>
Each domain must contain a unique set of documents. No single document can be in more than one domain.</Warning>
</WarningList>
<Body-indent>
<A ID="pgfId-1066173"></A>
<IMAGE xml:link="simple" href="images/domain1.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body>
<A ID="pgfId-1066512"></A>
The following procedure describes how to create a new domain for defining the scope of the replicated documents. By default, CPF creates a Default Master domain to replicate from the '/' root directory of the Master database. The '/' root means that the document URIs must be preceded by a '/', such as <code>
/foo.xml </code>
or <code>
/content/foo.xml</code>
. You can also set the Document Scope of the domain to replicate a user collection or an individual document.</Body>
<Number1>
<A ID="pgfId-1066290"></A>
To replicate a portion of a database, you can create another domain. For example, you can create a domain that specifies the documents in the <code>
/projects/Baz/</code>
 directory on the Master database, as shown below.</Number1>
<Body-indent>
<A ID="pgfId-1066297"></A>
<IMAGE xml:link="simple" href="images/domain2.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body-indent>
<A ID="pgfId-1066365"></A>
You may receive a warning that this domain overlaps with the Default Master domain. This means that the both the Baz domain and the Default Master domain are configured to replicate the documents in the <code>
/projects/Baz/</code>
 directory. You cannot have any document that is in more than one domain, so you must either delete or modify the Default Master to resolve this conflict.</Body-indent>
<Note>
<A ID="pgfId-1070202"></A>
If you want to create a domain to replicate the entire database, you can assign a default collection to all of your users and then set the Document Scope to Collections and the URI to the name of the default collection. For details on how to establish a default collection for a user, see <A href="../admin/security.xml#id(58960)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Creating a User</Hyperlink>
</A> in the <Emphasis>
Administrator's Guide</Emphasis>
.</Note>
<NumberList>
<Number>
<A ID="pgfId-1066463"></A>
Select Pipelines in the navigation frame and select the Flexible Replication and Status Change Handling pipelines. These are the minimum pipelines required for replication. You can select other pipelines, as required for your configuration.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1066403"></A>
<IMAGE xml:link="simple" href="images/pipelines.gif" show="embed" actuate="auto"/>
</Body-indent>
<Heading-2>
<A ID="pgfId-1071045"></A>
<A ID="70719"></A>
Configuring Replication App Servers</Heading-2>
<Body>
<A ID="pgfId-1071049"></A>
As described in <A href="quick_start.xml#id(79224)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Creating a Replication App Server' on page&#160;14</A>, in a push replication configuration, the Replica database must be connected to a Replication App Server. In a pull replication configuration, the Master database must be connected to a Replication App Server. This section goes into more detail on creating an configuring Replication App Servers.</Body>
<Number1>
<A ID="pgfId-1071041"></A>
Create a Replication App Server by clicking Create in the Application Server section of the Database Replication Administration page:</Number1>
<Body-indent>
<A ID="pgfId-1068327"></A>
<IMAGE xml:link="simple" href="images/app-server--create.gif" show="embed" actuate="auto"/>
</Body-indent>
<Note>
<A ID="pgfId-1068398"></A>
The Server Name, Root, and Database fields are preconfigured and should not be changed.</Note>
<NumberList>
<Number>
<A ID="pgfId-1068447"></A>
Enter a unique port number for the App Server:</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1068405"></A>
<IMAGE xml:link="simple" href="images/app-server-master-create2.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body-indent>
<A ID="pgfId-1068412"></A>
The purpose of the other fields in the HTTP Server Configuration page are described in <A href="../admin/http.xml#id(67435)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Creating a New HTTP Server</Hyperlink>
</A> in the <Emphasis>
Administrator's Guide</Emphasis>
. If you are going to configure SSL on the App Server to require a client certificate, you must specify the certificate in the Database Replication Target Administration configuration page, as described in <A href="configuring.xml#id(22183)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Replication Security' on page&#160;21</A>.</Body-indent>
<Body-indent>
<A ID="pgfId-1068497"></A>
For example, if you are configuring the Master database to push updates to a Replica App Server that requires a client certificate, you must include a client certificate in the Database Replication Target Administration configuration page for the Master database. If you are configuring a Replica App Server to pull updates from the Master database that requires a client certificate, you must you must include a client certificate in the Replication Pull configuration page for the Replica database. For details on providing a client certificate for either a push or pull replication configuration, see <A href="configuring.xml#id(22183)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Replication Security' on page&#160;21</A>.</Body-indent>
<Heading-2>
<A ID="pgfId-1066382"></A>
<A ID="23790"></A>
Configuring Push Replication</Heading-2>
<Body>
<A ID="pgfId-1070668"></A>
This section describes how to configure your Master database for Push Replication. </Body>
<Body>
<A ID="pgfId-1068007"></A>
Before you can configure a replication target, you must have content processing enabled for the Master database.</Body>
<Number1>
<A ID="pgfId-1067977"></A>
Under Databases, click the Master database.</Number1>
<NumberList>
<Number>
<A ID="pgfId-1067988"></A>
Click Flexible Replication under the Master database. </Number>
<Number>
<A ID="pgfId-1068000"></A>
Locate the Content Processing section on the Database Replication Administration page and click on the domain name.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1068035"></A>
<IMAGE xml:link="simple" href="images/flex-rep1.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1068036"></A>
Click Create to configure replication for the domain:</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1068040"></A>
<IMAGE xml:link="simple" href="images/flex-rep2.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1068041"></A>
Click Create to configure a replication target for the domain:</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1068023"></A>
<IMAGE xml:link="simple" href="images/flex-rep3.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1067955"></A>
In the Database Replication Target Administration page, specify a target name and one or more target URLs that include the hostname and port number you specified for your Replica App Servers in <A href="quick_start.xml#id(79224)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Creating a Replication App Server' on page&#160;14</A>. The Retry Seconds Min/Max and Documents Per Batch setting are for scheduled tasks, as described in <A href="configuring.xml#id(91720)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Creating a Scheduled Replication Task' on page&#160;30</A>. Under Authentication, specify the username and password for a user assigned the <code>
flexrep-user </code>
role. </Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1068219"></A>
You can optionally disable pushing replication to the target by setting <code>
Enabled</code>
 to <code>
false</code>
. Do not set the <code>
Replicate CPF</code>
 option to without the direction from MarkLogic Customer Support.</Body-indent>
<Body-indent>
<A ID="pgfId-1068223"></A>
<IMAGE xml:link="simple" href="images/target-rep-page1.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1068251"></A>
If the Replica App Server requires a client certificate, the Target URL must start with HTTPS. Paste the client certificate, client key and pass phrase (if the client key is encrypted) in the fields located at the bottom of the Database Replication Target Administration page. For details on how to configure the Master to provide a client certificate, see <A href="configuring.xml#id(22183)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Replication Security' on page&#160;21</A>.</Number>
</NumberList>
<Heading-2>
<A ID="pgfId-1068226"></A>
<A ID="91720"></A>
<A ID="66155"></A>
Creating a Scheduled Replication Task</Heading-2>
<Body>
<A ID="pgfId-1066680"></A>
You should create a scheduled task to periodically replicate updated content on the Master to the Replicas. A scheduled replication task can be used for the following:</Body>
<Body-bullet>
<A ID="pgfId-1066188"></A>
Move existing content that was on the Master before replication was configured (zero-day replication).</Body-bullet>
<Body-bullet>
<A ID="pgfId-1066189"></A>
Provides a retry mechanism in the event the initial replication fails.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1066696"></A>
Provides the ability to pull data from a Master server located outside a firewall.</Body-bullet>
<Body>
<A ID="pgfId-1066706"></A>
A scheduled task can be either a push operation on the Master to the Replicas, or a pull operation on a Replica from the Master. While a push replication scheduled task provides the Master with retry and zero-day replication, a pull replication scheduled task is the only replication option available to a Replica, so the scheduled task must serve as the initial replication mechanism in addition to retry and zero-day replication.</Body>
<Body>
<A ID="pgfId-1069395"></A>
For both push and pull scheduled replication tasks, the replication retry configuration is a combination of the scheduled task frequency settings and the target settings, Retry Seconds Min, Retry Seconds Max, and Document Per Batch.</Body>
<Body>
<A ID="pgfId-1069538"></A>
The task type in the Scheduled Task Configuration page indicates the interval at which each scheduled replication task is to run. In most configurations, the task type will be minutely. For details on configuring scheduled tasks, see <A href="../admin/scheduling_tasks.xml#id(44210)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Scheduling Tasks</Hyperlink>
</A> in the <Emphasis>
Administrator's Guide</Emphasis>
.</Body>
<Body-indent>
<A ID="pgfId-1069472"></A>
<IMAGE xml:link="simple" href="images/scheduled-task-type.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body>
<A ID="pgfId-1069439"></A>
The Retry Seconds Min/Max settings in the Database Replication Target Administration page indicate the minimum and maximum number of seconds any documents that failed to replicate are eligible for replication retries. In a push configuration, the Documents Per Batch setting specifies how many documents that have failed to replicate are to be retried during each scheduled task interval. In a pull configuration, the Documents Per Batch setting specifies the total number of replicated documents (retries of failed documents and newly added or updated documents) that are to be pulled from the Master during each scheduled task interval.</Body>
<Body-indent>
<A ID="pgfId-1069446"></A>
<IMAGE xml:link="simple" href="images/retry-settings.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body>
<A ID="pgfId-1069552"></A>
For example, the retry minimum is 30 seconds, the retry maximum is 300 seconds (five minutes) and the scheduled replication task period is every one minute. If a document fails replication, it is eligible to be retried in 30 seconds. This means that MarkLogic Server will attempt to replicate the document at the next minute interval. The retry interval is doubled each time the document fails to replicate until the interval reaches the maximum retry setting, at which time the retry interval remains at the maximum. So, if the document in our example fails a second time, it will be eligible for retry in one minute. Should the document fail to replicate the second time, the retry interval is set to two minutes, and so on until the interval reaches the five-minute retry maximum setting, after which MarkLogic Server tries to replicate the document every five minutes.</Body>
<Body>
<A ID="pgfId-1069581"></A>
The Documents Per Batch setting also plays a role with replication retries. For example, if the batch value is one and five documents have failed to replicate, then MarkLogic Server will only attempt to retry one failed document that is eligible for replication retries during each scheduled task interval. The document selected for replication retry is the earliest eligible document. Because of this, zero-day documents take precedence over documents that have failed replication. </Body>
<Body>
<A ID="pgfId-1071082"></A>
Though the Documents Per Batch setting is 1 by default, a more typical value is in the range of 10 - 100. If there is a large number of documents to be replicated in a zero-day fashion, you can maximize the load speed by closely matching the scheduled interval with the Documents Per Batch setting, so that the maximum number of documents are loaded within the time interval. For example, if your scheduled interval is one minute and you have determined that you can replicate a maximum of 250 documents per minute, then the optimum Documents Per Batch setting would be 250.</Body>
<Heading-3>
<A ID="pgfId-1066574"></A>
Creating a Push Replication Task</Heading-3>
<Body>
<A ID="pgfId-1069039"></A>
This section describes how to configure a push replication task to provide the Master with the means to retry replication on documents that have failed the initial attempt to replicate and to replicate documents that were in the replicated domain before replication was configured.</Body>
<Number1>
<A ID="pgfId-1066190"></A>
For the Master database, navigate to Flexible Replication and click Create under Scheduled Tasks:</Number1>
<Body-indent>
<A ID="pgfId-1066194"></A>
<IMAGE xml:link="simple" href="images/task-create1.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1066195"></A>
Create a Scheduled Tasks that defines the frequency in which documents are to be replicated from the Master to the Replica. You must also specify the task user and host.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1066199"></A>
<IMAGE xml:link="simple" href="images/task-create2.gif" show="embed" actuate="auto"/>
</Body-indent>
<Heading-3>
<A ID="pgfId-1066589"></A>
<A ID="23393"></A>
Creating a Pull Replication Task</Heading-3>
<Body>
<A ID="pgfId-1069028"></A>
In a pull replication configuration, the Replicas pull updates from the master. Unlike push replication, which replicates as soon as the documents on the Master are updated, the only way to configure pull replication is by means of a scheduled task.</Body>
<Number1>
<A ID="pgfId-1067701"></A>
On the Replica, create a scheduled task to pull the content from the Master:</Number1>
<Body-indent>
<A ID="pgfId-1067714"></A>
<IMAGE xml:link="simple" href="images/pull-task-create.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1067721"></A>
Specify the pull frequency and the fill in the user and host.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1067630"></A>
<IMAGE xml:link="simple" href="images/pull-task.gif" show="embed" actuate="auto"/>
</Body-indent>
<Heading-2>
<A ID="pgfId-1070632"></A>
<A ID="37645"></A>
Configuring Pull Replication</Heading-2>
<Body>
<A ID="pgfId-1070689"></A>
Pull Replication is useful when a Replica is behind a firewall that only allows its internal servers to pull from a Master server outside the firewall. This section describes how to configure your Replica database for Pull Replication. </Body>
<Note>
<A ID="pgfId-1070721"></A>
If the Replica is to act as a Master for another Replica, then you must have CPF enabled on the Replica, as described in <A href="quick_start.xml#id(58017)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Configuring a Flexible Replication Pipeline for the Master Database' on page&#160;11</A>. However, if the Replica has CPF installed and it is not to act as a Master, then you must disable the Flexible Replication pipeline on the Replica.</Note>
<Body>
<A ID="pgfId-1070737"></A>
The procedure for configuring Pull Replication on the Master and Replica databases is as follows:</Body>
<Number1>
<A ID="pgfId-1070757"></A>
Define a replication target for the Master Content Processing Domain with push replication disabled. You can do this by either not defining a target URL in the target configuration page or by disabling the replication target, or by doing both as shown below.</Number1>
<Body-indent>
<A ID="pgfId-1070761"></A>
<IMAGE xml:link="simple" href="images/target-rep-page-pull.gif" show="embed" actuate="auto"/>
 </Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1070798"></A>
Under Databases, click the Replica database.</Number>
<Number>
<A ID="pgfId-1070799"></A>
Click Flexible Replication under the Replica database. </Number>
<Number>
<A ID="pgfId-1070839"></A>
Create a Pull Replication Task, as described in <A href="configuring.xml#id(23393)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Creating a Pull Replication Task' on page&#160;34</A>.</Number>
<Number>
<A ID="pgfId-1070656"></A>
Under Pull Configuration, click Create:</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1067743"></A>
<IMAGE xml:link="simple" href="images/pull-config-create.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1067759"></A>
Obtain the Master domain id from the Database Domain Replication Summary page:</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1069992"></A>
<IMAGE xml:link="simple" href="images/domain_id.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1069968"></A>
Obtain the Replica target id from the Database Domain Replication Administration page:</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1069960"></A>
<IMAGE xml:link="simple" href="images/target_id.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1069935"></A>
Enter a pull name, the domain and target ids, and the URL for the Master App Server. Fill in the username and password fields. </Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1068232"></A>
<IMAGE xml:link="simple" href="images/pull-config.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1068817"></A>
You can optionally specify a client certificate, if one is required by the Master App Server. For details on how to configure the Replica to provide a client certificate, see <A href="configuring.xml#id(22183)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Replication Security' on page&#160;21</A>.</Number>
</NumberList>
<Heading-2>
<A ID="pgfId-1070264"></A>
<A ID="85704"></A>
Clearing the Master and Replica Databases</Heading-2>
<Body>
<A ID="pgfId-1070478"></A>
The replication configuration is stored in the Master and Replica databases. Clearing a Master database has the effect of deleting the target configurations, as well as all document-level information about target replication status. Before clearing a Master database, you can save the replication configuration by calling the <code>
flexrep:configuration-get </code>
function. Once the Master is cleared, the replication configuration can be restored using the <code>
flexrep:configuration-insert</code>
 function. Alternatively you can recreate the replication configuration programmatically, as described in <A href="../AdminAPI/flexrep.xml#id(87628)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Scripting Flexible Replication Configuration</Hyperlink>
</A> in the <Emphasis>
Scripting Administrative Tasks Guide</Emphasis>
.</Body>
<Body>
<A ID="pgfId-1070463"></A>
Clearing a Replica database impacts the Master in that it no longer understands the status of the target. New updates will replicate to the target, but the Master will not know that the older, unchanged documents are missing. Before clearing a Replica database, disable replication. After clearing the Replica database, delete the existing target on the Master, create a new target with the same configuration as the old one, and re-enable replication. The scheduled task will gradually populate the new target's database with all the documents in the domain. </Body>
<Body>
<A ID="pgfId-1070581"></A>
If you have pull replication configured on the Replica, then you can save the configuration by calling the <code>
flexrep:pull-get</code>
 function before clearing the database. After clearing the Replica database, you can restore the pull replication configuration by calling the <code>
flexrep:pull-insert </code>
function.</Body>
</XML>
