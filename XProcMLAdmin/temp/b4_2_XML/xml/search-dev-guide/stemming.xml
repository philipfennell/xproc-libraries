<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="stemming.css" type="text/css" charset="UTF-8"?>
<XML>
<TITLE> </TITLE><Heading-1>
<A ID="pgfId-1044986"></A>
<A ID="90878"></A>
Understanding and Using Stemmed Searches</Heading-1>
<pagenum>
<A ID="pgfId-1046322"></A>
138</pagenum>
<Body>
<A ID="pgfId-1044987"></A>
This chapter describes how to use the stemmed search functionality in MarkLogic Server. The following sections are included:</Body>
<Body-bullet>
<A ID="pgfId-1045592"></A>
<A href="stemming.xml#id(37129)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Stemming in MarkLogic Server</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1046056"></A>
<A href="stemming.xml#id(38984)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Enabling Stemming</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1046087"></A>
<A href="stemming.xml#id(22519)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Stemmed Searches Versus Word Searches</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1049934"></A>
<A href="stemming.xml#id(25293)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Using cts:highlight or cts:contains to Find if a Word Matches a Query</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1046060"></A>
<A href="stemming.xml#id(40082)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Interaction With Wildcard Searches</Hyperlink>
</A></Body-bullet>
<Heading-2>
<A ID="pgfId-1046062"></A>
<A ID="37129"></A>
Stemming in MarkLogic Server</Heading-2>
<Body>
<A ID="pgfId-1046063"></A>
MarkLogic Server supports stemming in English and other languages. For a list of languages in which stemming is supported, see <A href="languages.xml#id(64343)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Supported Languages' on page&#160;207</A>.</Body>
<Body>
<A ID="pgfId-1045998"></A>
If stemmed searches are enabled in the database configuration, MarkLogic Server automatically searches for words that come from the same <Emphasis>
stem</Emphasis>
 of the word specified in the query, not just the exact string specified in the query. A stemmed search for a word finds the exact same terms as well as terms that derive from the same meaning and part of speech as the search term. The stem of a word is not based on spelling. For example, <code>
card</code>
 and <code>
cardiac</code>
 have different stems even though the spelling of <code>
cardiac</code>
 begins with <code>
card</code>
. On the other hand, <code>
running</code>
 and <code>
ran</code>
 have the same stem (<code>
run</code>
) even though their spellings are quite different. If you want to search for word based on partial pattern matching (like the <code>
card</code>
 and <code>
cardiac</code>
 example above), use wildcard searches as described in <A href="wildcard.xml#id(66341)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Understanding and Using Wildcard Searches' on page&#160;139</A>.</Body>
<Body>
<A ID="pgfId-1046018"></A>
Stemming enables the search to return highly relevant matches that would otherwise be missed. For example, the terms <code>
run</code>
, <code>
running</code>
, and <code>
ran</code>
 all have the same stem. Therefore, a stemmed search for the term <code>
run</code>
 returns results that match elements containing the terms <code>
running</code>
, <code>
ran</code>
, and <code>
runs</code>
, as well as results for the specified term <code>
run</code>
.</Body>
<Body>
<A ID="pgfId-1046232"></A>
The stemming supported in MarkLogic Server does not cross different parts of speech. For example, <code>
conserve</code>
 (verb) and <code>
conservation</code>
 (noun) are not considered to have the same stem because they have different parts of speech. Consequently, if you search for <code>
conserve</code>
 with stemmed searches enabled, the results will include documents containing <code>
conserve</code>
 and <code>
conserves</code>
, but not documents with <code>
conservation</code>
 (unless <code>
conserve</code>
 or <code>
conserves</code>
 also appears). </Body>
<Body>
<A ID="pgfId-1050853"></A>
Stemming is language-specific, that is, each word is treated to be in the specified language. The language can be specified with an <code>
xml:lang</code>
 attribute or by several other methods, and a term in one language will not match a stemmed search for the same term in another language. For details on how languages affect queries, see <A href="languages.xml#id(90159)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Querying Documents By Languages' on page&#160;204</A>.</Body>
<Heading-2>
<A ID="pgfId-1050712"></A>
<A ID="38984"></A>
Enabling Stemming</Heading-2>
<Body>
<A ID="pgfId-1050713"></A>
To use stemming in your searches, stemming must be enabled in your database configuration. All new databases created in MarkLogic Server have stemming enabled by default. Stemmed searches require indexes which are created at load, update, or reindex time. If you enable stemming in an existing database that did not previously have stemming enabled, you must either reload or reindex the database to ensure that you get stemmed results from searches. You should plan on allocating an additional amount of disk space about twice the size of the source content if you enable stemming.</Body>
<Body>
<A ID="pgfId-1050732"></A>
There are three types of stemming available in MarkLogic Server: basic, advanced, and decompounding. The following table describes the stemming options available on the database configuration page of the Admin Interface.</Body>
<TableAnchor>
<A ID="pgfId-1050736"></A>
</TableAnchor>
<TABLE>
<ROW>
<TH ROWSPAN="1" COLSPAN="1">
<CellHeading>
<A ID="pgfId-1050742"></A>
Stemming Option</CellHeading>
</TH>
<TH ROWSPAN="1" COLSPAN="1">
<CellHeading>
<A ID="pgfId-1050744"></A>
Description</CellHeading>
</TH>
</ROW>
<ROW>
<CELL ROWSPAN="1" COLSPAN="1">
<CellBody>
<A ID="pgfId-1050746"></A>
OFF</CellBody>
</CELL>
<CELL ROWSPAN="1" COLSPAN="1">
<CellBody>
<A ID="pgfId-1050748"></A>
No words are indexed for stemming.</CellBody>
</CELL>
</ROW>
<ROW>
<CELL ROWSPAN="1" COLSPAN="1">
<CellBody>
<A ID="pgfId-1050750"></A>
Basic</CellBody>
</CELL>
<CELL ROWSPAN="1" COLSPAN="1">
<CellBody>
<A ID="pgfId-1050752"></A>
This is the default. Each word is indexed to a single stem.</CellBody>
</CELL>
</ROW>
<ROW>
<CELL ROWSPAN="1" COLSPAN="1">
<CellBody>
<A ID="pgfId-1050754"></A>
Advanced</CellBody>
</CELL>
<CELL ROWSPAN="1" COLSPAN="1">
<CellBody>
<A ID="pgfId-1050756"></A>
Each word is indexed to one or more stems. Some words can have two or more meanings, and can therefore have multiple stems. For example, the word <code>
further</code>
 stems to <code>
further</code>
 (as in <Emphasis>
he attended the party to further his career</Emphasis>
) and it stems to <code>
far</code>
 (as in <Emphasis>
she was further along in her studies than he</Emphasis>
).</CellBody>
</CELL>
</ROW>
<ROW>
<CELL ROWSPAN="1" COLSPAN="1">
<CellBody>
<A ID="pgfId-1050758"></A>
Decompounding</CellBody>
</CELL>
<CELL ROWSPAN="1" COLSPAN="1">
<CellBody>
<A ID="pgfId-1050760"></A>
All stems for each word are indexed, and smaller component words of large compound words are also indexed. Mostly used in languages such as German that use compound words.</CellBody>
</CELL>
</ROW>
</TABLE>
<Body>
<A ID="pgfId-1045006"></A>
If stemming is enabled for the database, you can further control the use of stemming at the query level. Stemming can be used with any of the MarkLogic <code>
cts:query</code>
 constructor functions, such as <code>
cts:word-query</code>
, <code>
cts:element-word-query</code>
, and <code>
cts:element-value-query</code>
. Stemming options, <code>
&quot;stemmed&quot;</code>
 or <code>
&quot;unstemmed&quot;</code>
, can be specified in the options parameter to the <code>
cts:query</code>
 constructor. For more details on these functions, see the <Emphasis>
MarkLogic XQuery and XSLT Function Reference</Emphasis>
 (<Hyperlink>
<A href="http://developer.marklogic.com/pubs" xml:link="simple" show="replace" actuate="user" CLASS="URL">http://developer.marklogic.com/pubs</A></Hyperlink>
).</Body>
<Body>
<A ID="pgfId-1045007"></A>
Query terms that contain a wildcard will not be stemmed. If you leave the stemming option unspecified, the system will perform a stemmed search for any word that does not contain a wildcard. Therefore, as long as stemming is enabled in the database, you do not have to enable stemming explicitly in a query.</Body>
<Body>
<A ID="pgfId-1045008"></A>
If stemming is turned off in the database, and stemming is explicitly specified in the query, the query will throw an error.</Body>
<Heading-2>
<A ID="pgfId-1045073"></A>
<A ID="22519"></A>
Stemmed Searches Versus Word Searches</Heading-2>
<Body>
<A ID="pgfId-1046082"></A>
The stemmed search indexes and word search (unstemmed) indexes have overlapping functionality, and there is a good chance you can get the results you want with only the stemmed search indexes enabled (that is, leaving the word search indexes turned off). </Body>
<Body>
<A ID="pgfId-1046257"></A>
Stemmed searches return relevance-ranked results for the words you search for <Emphasis>
as well as for</Emphasis>
 words with the same stem as the words you search for. Therefore, you will get the same results as with a word search plus the results for items containing words with the same stem. In most search applications, this is the desirable behavior.</Body>
<Body>
<A ID="pgfId-1046098"></A>
The only time you need to also have word search indexes enabled is when your application requires an exact word search to <Emphasis>
only</Emphasis>
 return the exact match results (that is, to <Emphasis>
not</Emphasis>
 return results based on stemming). </Body>
<Body>
<A ID="pgfId-1050817"></A>
Additionally, the stemmed search indexes take up less disk space than the word search (unstemmed) indexes. You can therefore save some disk space and decrease load time when you use the default settings of stemmed search enabled and word search turned off in the database configuration. Every index has a cost in terms of disk space used and increased load times. You have to decide based on your application requirements if the cost of creating extra indexes is worthwhile for your application, and whether you can fulfill the same requirements without some of the indexes.</Body>
<Body>
<A ID="pgfId-1050905"></A>
If you do need to perform word (unstemmed) searches when you only have stemmed search indexes enabled (that is, when word searches are turned off in the database configuration), you must do so by first doing a stemmed search and then filtering the results with an unstemmed <code>
cts:query</code>
, as described in <A href="languages.xml#id(50842)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Unstemmed Searches' on page&#160;205</A>.</Body>
<Heading-2>
<A ID="pgfId-1046081"></A>
<A ID="25293"></A>
Using cts:highlight or cts:contains to Find if a Word Matches a Query</Heading-2>
<Body>
<A ID="pgfId-1049709"></A>
Because stemming enables query matches for terms that do not have the same spelling, it can sometimes be difficult to find the words that actually caused the query to match. You can use <code>
cts:highlight</code>
 to test and/or highlight the words that actually matched the query. For details on <code>
cts:highlight</code>
, see the <Emphasis>
MarkLogic XQuery and XSLT Function Reference</Emphasis>
 and <A href="highlight.xml#id(12896)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Highlighting Search Term Matches' on page&#160;96</A>.</Body>
<Body>
<A ID="pgfId-1049939"></A>
You can also use <code>
cts:contains</code>
 to test if a word matches the query. The <code>
cts:contains</code>
 function returns <code>
true</code>
 if there is a match, <code>
false</code>
 if there is no match. For example, you can use the following function to test if a word has the same stem as another word.</Body>
<Code>
<A ID="pgfId-1049968"></A>
xquery version &quot;1.0-ml&quot;;
declare function local:same-stem(
&#160;&#160;$word1 as xs:string, $word2 as xs:string) 
&#160;&#160;as xs:boolean 
{
&#160;&#160;cts:contains(text{$word1},$word2)
};

(: The following returns true because 
&#160;&#160;&#160;running has the same stem as run :)
local:same-stem(&quot;run&quot;, &quot;running&quot;) </Code>
<Heading-2>
<A ID="pgfId-1049706"></A>
<A ID="40082"></A>
Interaction With Wildcard Searches</Heading-2>
<Body>
<A ID="pgfId-1046072"></A>
For information about how stemmed searches and Wildcard searches interact, see <A href="wildcard.xml#id(38546)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Interaction with Other Search Features' on page&#160;143</A>.</Body>
</XML>
