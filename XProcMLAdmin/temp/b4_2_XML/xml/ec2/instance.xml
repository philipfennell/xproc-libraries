<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="instance.css" type="text/css" charset="UTF-8"?>
<XML>
<TITLE> </TITLE><Heading-1>
<A ID="pgfId-1051062"></A>
Installing a MarkLogic Server AMI</Heading-1>
<pagenum>
<A ID="pgfId-1069217"></A>
25</pagenum>
<Body>
<A ID="pgfId-1067001"></A>
This chapter describes how to launch a MarkLogic Server AMI and access the MarkLogic Server Admin interface. This chapter includes the following sections:</Body>
<Body-bullet>
<A ID="pgfId-1067005"></A>
<A href="instance.xml#id(20567)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Initial Setup Procedures</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1066248"></A>
<A href="instance.xml#id(25305)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Creating an Instance of MarkLogic Server from an AMI</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1066883"></A>
<A href="instance.xml#id(81403)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Creating an EBS Volume and Attaching it to an Instance</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1064150"></A>
<A href="instance.xml#id(18558)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Accessing the MarkLogic Server Admin Interface</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1067894"></A>
<A href="instance.xml#id(39466)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Moving an EBS Volume Between Instances</Hyperlink>
</A></Body-bullet>
<Body>
<A ID="pgfId-1066164"></A>
Examples in this chapter reference the browser-based AWS Management Console. Amazon also provides a Firefox plugin (ElasticFox), as well as a set of command-line tools and query APIs that provide equivalent mechanisms for performing the procedures outlined in this guide. </Body>
<Heading-2>
<A ID="pgfId-1063368"></A>
<A ID="20567"></A>
Initial Setup Procedures</Heading-2>
<Body>
<A ID="pgfId-1066179"></A>
This section describes how to access the AWS management console and create a security group and key pair. Typically, you will create your security groups and key pairs once and reuse them for each instance you create. The topics in this section are:</Body>
<Body-bullet>
<A ID="pgfId-1066188"></A>
<A href="instance.xml#id(69008)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Accessing the AWS Management Console</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1067816"></A>
<A href="instance.xml#id(69725)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Creating a Security Group</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1067820"></A>
<A href="instance.xml#id(24571)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Creating a Key Pair</Hyperlink>
</A></Body-bullet>
<Heading-3>
<A ID="pgfId-1067822"></A>
<A ID="69008"></A>
Accessing the AWS Management Console</Heading-3>
<Body>
<A ID="pgfId-1064411"></A>
This section describes how to access the Amazon AWS Management Console.</Body>
<Number1>
<A ID="pgfId-1062809"></A>
Log into your Amazon EC2 account and from the Your Account menu, select AWS Management Console: </Number1>
<Body-indent>
<A ID="pgfId-1062823"></A>
<IMAGE xml:link="simple" href="images/open_console.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1062816"></A>
Click Sign into the AWS Management Console and enter your email address and password for your EC2 account:</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1062143"></A>
<IMAGE xml:link="simple" href="images/signin_console.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1067064"></A>
The AWS Management Console appears:</Number>
</NumberList>
<Body>
<A ID="pgfId-1067090"></A>
<IMAGE xml:link="simple" href="images/AWS_console.gif" show="embed" actuate="auto"/>
</Body>
<Heading-3>
<A ID="pgfId-1062144"></A>
<A ID="69725"></A>
Creating a Security Group</Heading-3>
<Body>
<A ID="pgfId-1065900"></A>
A Security group is a named collection of firewall access rules for your EC2 instance. These access rules control the incoming network traffic delivered to your instance. Any incoming network traffic that does not pass the rules established in your security group is discarded. This section describes how to create a security group.</Body>
<Number1>
<A ID="pgfId-1065917"></A>
From the AWS Management Console, select Security Groups from the left-hand navigation section:</Number1>
<Body-indent>
<A ID="pgfId-1064459"></A>
<IMAGE xml:link="simple" href="images/create_security_group.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1064491"></A>
In the Security Groups page, click Create Security Group:</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1064492"></A>
<IMAGE xml:link="simple" href="images/create_security_group2.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1064566"></A>
You will be prompted for a name and description for this new security group. Enter the name and description and click Create:</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1064617"></A>
<IMAGE xml:link="simple" href="images/create_security_group3.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1064610"></A>
Select the newly created security group in the Security Groups page. In the Allowed Connections section below, specify the connection method (in this case HTTP), protocol (TCP), port range, and source IP or group. Specify a port range that includes 8001 for the MarkLogic Server Admin interface, as well as any other ports required for your MarkLogic Server applications.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1064666"></A>
In order to secure your internal ports from attack, you can specify a source IP subnet or group for port 8001, as well as any other ports not intended for access by the general public. You might also want to specify port 22 for SSH access. Click Save for each port configuration you specify for this security group. </Body-indent>
<Body>
<A ID="pgfId-1062146"></A>
<IMAGE xml:link="simple" href="images/create_security_group5.gif" show="embed" actuate="auto"/>
</Body>
<Heading-3>
<A ID="pgfId-1066127"></A>
<A ID="24571"></A>
Creating a Key Pair</Heading-3>
<Body>
<A ID="pgfId-1066302"></A>
A key pair ensures that only you have access to your instances. You can create one or more Amazon EC2 key pairs. You can use a key pair to SSH to your instance.</Body>
<Number1>
<A ID="pgfId-1066361"></A>
From the AWS Management Console, select Key Pairs from the left-hand navigation section and click Create Key Pair in the Key Pairs page:</Number1>
<Body-indent>
<A ID="pgfId-1066315"></A>
<IMAGE xml:link="simple" href="images/create_key_pair1.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1066439"></A>
Enter a name for your key pair and click Create:</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1066440"></A>
<IMAGE xml:link="simple" href="images/create_key_pair2.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1066441"></A>
Your key pair will be downloaded to your local system. When the download of the key pair completes, click Save File. </Number>
</NumberList>
<Note>
<A ID="pgfId-1067938"></A>
You will need to remember the location of the downloaded key pair on your local system should you need to create an SSH connection to your MarkLogic Server instance, as described in <A href="instance.xml#id(39466)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Moving an EBS Volume Between Instances' on page&#160;22</A>.</Note>
<Heading-2>
<A ID="pgfId-1063347"></A>
<A ID="25305"></A>
Creating an Instance of MarkLogic Server from an AMI</Heading-2>
<Body>
<A ID="pgfId-1066550"></A>
This section describes how to create an instance of MarkLogic Server from a MarkLogic Server AMI.</Body>
<Number1>
<A ID="pgfId-1066481"></A>
From the AWS Management Console, select Instances from the left-hand navigation section and click Launch Instance in the My Instances page:</Number1>
<Body-indent>
<A ID="pgfId-1066494"></A>
<IMAGE xml:link="simple" href="images/launch_instance.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1066587"></A>
Select the Community AMIs tab and enter <code>
marklogic</code>
 in the search box.</Number>
<Number>
<A ID="pgfId-1066606"></A>
From the list of MarkLogic Server AMIs, locate the AMI from which you want to create your instance and click Select:</Number>
</NumberList>
<Body>
<A ID="pgfId-1066591"></A>
<IMAGE xml:link="simple" href="images/instances.gif" show="embed" actuate="auto"/>
</Body>
<NumberList>
<Number>
<A ID="pgfId-1066529"></A>
In the Launch Instance Wizard page, enter the number of instances, the availability zone, and the instance type (the memory and CPU resources to be used to host the instance). Select Launch Instances to pay for the Amazon resources used by your instance by the hour. Click Continue.</Number>
</NumberList>
<Body>
<A ID="pgfId-1066912"></A>
<IMAGE xml:link="simple" href="images/launch_instance_wiz.gif" show="embed" actuate="auto"/>
</Body>
<NumberList>
<Number>
<A ID="pgfId-1067179"></A>
Click the defaults on this page. Click Continue.</Number>
</NumberList>
<Body>
<A ID="pgfId-1067186"></A>
<IMAGE xml:link="simple" href="images/request_instances_wiz.gif" show="embed" actuate="auto"/>
</Body>
<NumberList>
<Number>
<A ID="pgfId-1067347"></A>
Select the key pair you created, as described in <A href="instance.xml#id(24571)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Creating a Key Pair' on page&#160;11</A>, or create a new key pair. Click Continue.</Number>
</NumberList>
<Body>
<A ID="pgfId-1067213"></A>
<IMAGE xml:link="simple" href="images/request_instances_wiz2.gif" show="embed" actuate="auto"/>
</Body>
<NumberList>
<Number>
<A ID="pgfId-1067454"></A>
Select the security group you created, as described in <A href="instance.xml#id(69725)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Creating a Security Group' on page&#160;8</A>, or create a new security group. Click Continue.</Number>
</NumberList>
<Body>
<A ID="pgfId-1067247"></A>
<IMAGE xml:link="simple" href="images/request_instances_wiz3.gif" show="embed" actuate="auto"/>
</Body>
<NumberList>
<Number>
<A ID="pgfId-1067261"></A>
Click Launch to create the instance.</Number>
</NumberList>
<Body>
<A ID="pgfId-1067288"></A>
<IMAGE xml:link="simple" href="images/request_instances_wiz4.gif" show="embed" actuate="auto"/>
</Body>
<Note>
<A ID="pgfId-1067755"></A>
It may take up to several minutes before your MarkLogic Server instance changes from <code>
pending</code>
 to <code>
running</code>
 status. Click <code>
Refresh</code>
 to view the current status of your instance.</Note>
<NumberList>
<Number>
<A ID="pgfId-1067160"></A>
Select your EC2 instance and, in the Description section of the screen, note the Zone in which the instance was created. This will be needed when attaching your EBS volume to this instance.</Number>
</NumberList>
<Body>
<A ID="pgfId-1067148"></A>
<IMAGE xml:link="simple" href="images/my_instances.gif" show="embed" actuate="auto"/>
</Body>
<Heading-2>
<A ID="pgfId-1062957"></A>
<A ID="81403"></A>
Creating an EBS Volume and Attaching it to an Instance</Heading-2>
<Body>
<A ID="pgfId-1066861"></A>
This section describes how to create an EBS volume and attach it to your MarkLogic Server instance.</Body>
<Number1>
<A ID="pgfId-1066813"></A>
From the AWS Management Console, select Volumes from the left-hand navigation section. In the EBS Volumes page, select Create Volume:</Number1>
<Body-indent>
<A ID="pgfId-1066805"></A>
<IMAGE xml:link="simple" href="images/create_volume1.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1062157"></A>
In the Create Volume window, specify a volume size large enough for your needs and the same availability zone associated with your instance. Specify the same zone as the instance to which you intend to attach the volume. You can also optionally specify an EBS snapshot. See Help on the EBS snapshot page for details on how to create a snapshot. </Number>
<Warning>
<A ID="pgfId-1067791"></A>
The zones for your instance and EBS volume may not be the same by default.</Warning>
</NumberList>
<Body-indent>
<A ID="pgfId-1064995"></A>
When finished, click Create. Locate the reference to this new volume in the right-hand section of the management console and verify that the status is available.</Body-indent>
<Body-indent>
<A ID="pgfId-1062158"></A>
<IMAGE xml:link="simple" href="images/create_volume.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1065068"></A>
From the AWS Management Console, Amazon EC2 tab, select Volumes from the left-hand navigation section and then click Attach Volume.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1063135"></A>
<IMAGE xml:link="simple" href="images/EBSvolume.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1065100"></A>
In the Attach Volume window, specify the instance you launched from the MarkLogic Server AMI. For the Device selection, use <code>
/dev/sdf</code>
. Click Attach when you are finished. Locate the reference to this volume in the right-hand section of the management console and verify that the status is &quot;in-use&quot;. If the status is not 'in-use,' continue to click Refresh until the status changes to 'in-use.'</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1063099"></A>
<IMAGE xml:link="simple" href="images/attach_volume.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body>
<A ID="pgfId-1067853"></A>
When MarkLogic Server starts up, it will attempt to mount an EBS volume named <code>
MARKLOGIC_EBS</code>
 at location /dev/sdf. You can mount your EBS volume in a different location by using SSH to access the instance and then changing the device path specified in <code>
/etc/sysconfig/MarkLogic</code>
 and rebooting. </Body>
<Note>
<A ID="pgfId-1067854"></A>
MarkLogic expects use of an EBS volume to be the appropriate storage choice for the majority of use cases. If, however, you prefer to use local storage, you can SSH to the instance and comment out the <code>
MARKLOGIC_EBS</code>
 variable in <code>
/etc/sysconfig/MarkLogic</code>
, in which case the server will store its data locally. Repackaging the AMI will also have the effect of MarkLogic Server defaulting to local storage. Please be aware that using the local storage will not persist the stored data when the instance is terminated or if it fails. For example, if <code>
/var/opt/MarkLogic</code>
 is local, it will disappear when the instance is terminated or fails.</Note>
<Heading-2>
<A ID="pgfId-1062514"></A>
<A ID="18558"></A>
Accessing the MarkLogic Server Admin Interface</Heading-2>
<Body>
<A ID="pgfId-1067617"></A>
This section describes how to access the Admin interface for your instance of MarkLogic Server.</Body>
<Number1>
<A ID="pgfId-1064121"></A>
From the AWS Management Console, select Instances from the left-hand navigation section. Locate your MarkLogic Server instance and copy the Public DNS value: </Number1>
<Body>
<A ID="pgfId-1064125"></A>
<IMAGE xml:link="simple" href="images/public_DNS.gif" show="embed" actuate="auto"/>
</Body>
<Body-indent>
<A ID="pgfId-1064126"></A>
You use the Public DNS to formulate part of the URL to access the MarkLogic Server administration console. For example, if the Public DNS is <code>
ec2-75-101-210-0.compute-1.amazonaws.com</code>
, then the URL you enter into the browser would be:</Body-indent>
<Code>
<A ID="pgfId-1064127"></A>
http://ec2-75-101-210-0.compute-1.amazonaws.com:8001</Code>
<NumberList>
<Number>
<A ID="pgfId-1064130"></A>
After entering the URL in your browser, you will be presented with a welcome screen. After clicking OK, you will be presented with the Amazon Machine Image End User License Agreement. Once you accept the terms of the agreement, click Accept. </Number>
</NumberList>
<Body>
<A ID="pgfId-1062534"></A>
<IMAGE xml:link="simple" href="images/first_page.gif" show="embed" actuate="auto"/>
</Body>
<NumberList>
<Number>
<A ID="pgfId-1062517"></A>
In the Server Install page, click OK:</Number>
</NumberList>
<Body>
<A ID="pgfId-1062563"></A>
<IMAGE xml:link="simple" href="images/server_install.gif" show="embed" actuate="auto"/>
</Body>
<NumberList>
<Number>
<A ID="pgfId-1062518"></A>
In the Security Setup page, enter the name and password for the administrator:</Number>
</NumberList>
<Body>
<A ID="pgfId-1062579"></A>
<IMAGE xml:link="simple" href="images/security_setup.gif" show="embed" actuate="auto"/>
</Body>
<NumberList>
<Number>
<A ID="pgfId-1065327"></A>
You now have access to the MarkLogic Server Admin interface:</Number>
</NumberList>
<Body>
<A ID="pgfId-1062087"></A>
<IMAGE xml:link="simple" href="images/admin_page.gif" show="embed" actuate="auto"/>
</Body>
<NumberList>
<Number>
<A ID="pgfId-1062094"></A>
For information on getting started with MarkLogic Server and administrative tasks, go to the following URL and review the <Emphasis>
Getting Started with MarkLogic Server</Emphasis>
 Guide and the <Emphasis>
Administrator's Guide</Emphasis>
:</Number>
</NumberList>
<Code>
<A ID="pgfId-1062101"></A>
<Hyperlink>
<A href="http://developer.marklogic.com/pubs" xml:link="simple" show="replace" actuate="user" CLASS="URL">http://developer.marklogic.com/pubs</A></Hyperlink>
</Code>
<Heading-2>
<A ID="pgfId-1062108"></A>
<A ID="39466"></A>
Moving an EBS Volume Between Instances</Heading-2>
<Body>
<A ID="pgfId-1067924"></A>
This section describes how to move an EBS volume from one MarkLogic Server instance to another. For example, you may want to populate an EBS volume using one MarkLogic Server instance for development and testing your applications and then later move it to a new instance for deployment. The topics in this section are:</Body>
<Body-bullet>
<A ID="pgfId-1068935"></A>
<A href="instance.xml#id(38101)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Terminating a MarkLogic Server Instance</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1068960"></A>
<A href="instance.xml#id(16419)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Attaching an Exisiting EBS Volume to a New Instance</Hyperlink>
</A></Body-bullet>
<Heading-3>
<A ID="pgfId-1068832"></A>
<A ID="38101"></A>
Terminating a MarkLogic Server Instance</Heading-3>
<Body>
<A ID="pgfId-1068845"></A>
To terminate an existing instance of MarkLogic Server, do the following:</Body>
<Number1>
<A ID="pgfId-1068002"></A>
Select Volumes from the left-hand navigation section and create a snapshot of the volume attached to your MarkLogic Server instance.</Number1>
<Body-indent>
<A ID="pgfId-1068131"></A>
<IMAGE xml:link="simple" href="images/create-snapshot.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1068310"></A>
Select Instances from the left-hand navigation section and select Connect from the Instance Actions pull-down menu.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1068277"></A>
<IMAGE xml:link="simple" href="images/InstanceConnect.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1068330"></A>
Open up a command line window, such as a Cygwin Bash Shell or a Putty terminal window. Navigate to the directory in which you stored the key pair you downloaded in <A href="instance.xml#id(24571)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Creating a Key Pair' on page&#160;11</A> and change the permission on the key pair file, as directed in the Connect Help window. Next, enter the command line at the bottom of the Connect Help window to create an SSH connection to your MarkLogic Server instance. </Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1068282"></A>
<IMAGE xml:link="simple" href="images/ConnectHelp.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1068249"></A>
Once you have established an SSH connection to your MarkLogic Server instance, enter the following command in your command line window to stop MarkLogic Server:</Number>
</NumberList>
<Code>
<A ID="pgfId-1068404"></A>
/etc/init.d/MarkLogic stop</Code>
<NumberList>
<Number>
<A ID="pgfId-1068235"></A>
Return to the AWS Management Console and select Instances from the left-hand navigation section. Select the instance to be terminated and, from the Instance Actions pull-down menu, select Terminate.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1068149"></A>
<IMAGE xml:link="simple" href="images/instance-terminate.gif" show="embed" actuate="auto"/>
</Body-indent>
<Heading-3>
<A ID="pgfId-1068855"></A>
<A ID="16419"></A>
Attaching an Exisiting EBS Volume to a New Instance</Heading-3>
<Body>
<A ID="pgfId-1068914"></A>
To create a new instance of MarkLogic Server to use the data in an existing EBS volume, do the following:</Body>
<NumberList>
<Number>
<A ID="pgfId-1068156"></A>
Create your new instance of MarkLogic Server, as described in <A href="instance.xml#id(25305)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Creating an Instance of MarkLogic Server from an AMI' on page&#160;12</A>. </Number>
</NumberList>
<Note>
<A ID="pgfId-1068551"></A>
When creating the new instance, be sure to assign it the same zone as the old instance.</Note>
<NumberList>
<Number>
<A ID="pgfId-1068484"></A>
Select Volumes from the left-hand navigation section and click Refresh.</Number>
<Number>
<A ID="pgfId-1068534"></A>
Click Attach Volume to attach the volume to your new MarkLogic Server instance.</Number>
<Number>
<A ID="pgfId-1068163"></A>
In your browser, use the Public DNS from your new instance to access the Admin Interface. For example, if the Public DNS of the new instance is:</Number>
</NumberList>
<Code>
<A ID="pgfId-1068642"></A>
ec2-204-236-223-250.compute-1.amazonaws.com</Code>
<Body-indent>
<A ID="pgfId-1068170"></A>
then you use the following URL to access the Admin Interface:</Body-indent>
<Code>
<A ID="pgfId-1068650"></A>
http://ec2-204-236-223-250.compute-1.amazonaws.com:8001</Code>
<NumberList>
<Number>
<A ID="pgfId-1068177"></A>
In the Admin Interface, select Hosts from the left-hand navigation section. Click the hostname to open the Host Configuration window. Note that the Host Name in the Host Configuration window is the Public DNS of the terminated instance. Replace the Host Name with the Public DNS of the new instance and click OK.</Number>
</NumberList>
</XML>
