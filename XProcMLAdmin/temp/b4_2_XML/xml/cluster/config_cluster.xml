<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="config_cluster.css" type="text/css" charset="UTF-8"?>
<XML>
<TITLE> </TITLE><Heading-1>
<A ID="pgfId-1040610"></A>
<A ID="79252"></A>
Configuring a Cluster</Heading-1>
<pagenum>
<A ID="pgfId-1044007"></A>
42</pagenum>
<Body>
<A ID="pgfId-1040681"></A>
This chapter describes some of the basic configuration tasks for a cluster. When you have a cluster, you can perform most administrative tasks from the Admin Interface of any node in the cluster. This chapter describes some of those cluster tasks and includes the following sections:</Body>
<Body-bullet>
<A ID="pgfId-1052539"></A>
<A href="config_cluster.xml#id(86196)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Determining Which Nodes Are in Which Group in a Cluster</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1052543"></A>
<A href="config_cluster.xml#id(65834)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Adding Another Node to a Cluster</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1052544"></A>
<A href="config_cluster.xml#id(85628)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Removing a Node from a Cluster</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1052545"></A>
<A href="config_cluster.xml#id(21237)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Upgrading a Cluster to a New Maintenance Release of MarkLogic Server</Hyperlink>
</A></Body-bullet>
<Heading-2>
<A ID="pgfId-1051492"></A>
<A ID="86196"></A>
Determining Which Nodes Are in Which Group in a Cluster</Heading-2>
<Body>
<A ID="pgfId-1052420"></A>
The Admin Interface has summary and status screens to help you determine the makeup of a cluster. The system summary page (the default Admin Interface page when you log in) has links to each group and to each host in the cluster. If you have a cluster with multiple groups configured and you click on a group, the Admin Interface displays a group summary page which shows all of the hosts in a group. For each group, there is also a status page.</Body>
<Body>
<A ID="pgfId-1052548"></A>
Similarly, each host has a summary page and a status page. For more details about the status pages, see <A href="../performance/status.xml#id(37719)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Monitoring MarkLogic Server Performance</Hyperlink>
</A> in the <Emphasis>
Query Performance and Tuning Guide</Emphasis>
 book.</Body>
<Heading-2>
<A ID="pgfId-1052419"></A>
<A ID="65834"></A>
Adding Another Node to a Cluster</Heading-2>
<Body>
<A ID="pgfId-1052405"></A>
This section describes the general procedure for adding a new node to an existing cluster. For more detailed installation instructions, including the procedure to add a new node to a cluster, see the <Emphasis>
Installation Guide</Emphasis>
. </Body>
<Body>
<A ID="pgfId-1052561"></A>
The following are the general steps needed to add another node to an existing cluster (the existing cluster can have one or more hosts):</Body>
<NumberList>
<Number>
<A ID="pgfId-1052880"></A>
Install MarkLogic Server on the new host. All hosts in the cluster must run the same version of MarkLogic Server.</Number>
<Number>
<A ID="pgfId-1052574"></A>
Access the Admin Interface on the new host. For example, if the host is installed on a machine named <code>
raymond</code>
, access <Hyperlink>
http://raymond:8001</Hyperlink>
.</Number>
<Number>
<A ID="pgfId-1052581"></A>
On the License Key Entry page, enter a valid licensee and corresponding license key. You need an Enterprise license key to be part of a cluster. The license keys are specific to a named machine. MarkLogic Server will restart after you enter the license key.</Number>
<Number>
<A ID="pgfId-1052593"></A>
Accept the license agreement. MarkLogic Server will restart after you accept the license agreement.</Number>
</NumberList>
<Note>
<A ID="pgfId-1052596"></A>
Accepting this license agreement is optional. However, to begin using MarkLogic Server, you must accept the terms and conditions outlined in the license agreement. If you have executed a written software license with MarkLogic Corporation, the agreement displayed references that written agreement.</Note>
<NumberList>
<Number>
<A ID="pgfId-1052589"></A>
On the Server Install page, click OK to install the initial servers. MarkLogic Server will restart after you click OK.</Number>
<Number>
<A ID="pgfId-1052627"></A>
On the Join a Cluster page, enter the name of any host in the cluster, with the port number of its Admin Interface. Then Click the OK button.</Number>
<Number>
<A ID="pgfId-1052651"></A>
On the next Join a Cluster page, select the group to which you want to join. Then Click the OK button. </Number>
<Number>
<A ID="pgfId-1052658"></A>
On the next Join a Cluster page, click OK to confirm that you want to join a cluster.</Number>
<Number>
<A ID="pgfId-1052659"></A>
On the Joined a Cluster page, click OK to transfer cluster information to the new node in the cluster. MarkLogic Server will restart on the new node after you click OK.</Number>
<Number>
<A ID="pgfId-1052632"></A>
After the MarkLogic Server restarts on the node, it prompts you for a username and password. Enter a username and password for the Admin Interface.</Number>
</NumberList>
<Body>
<A ID="pgfId-1052639"></A>
The new node is now part of the cluster.</Body>
<Heading-2>
<A ID="pgfId-1052406"></A>
<A ID="85628"></A>
Removing a Node from a Cluster</Heading-2>
<Body>
<A ID="pgfId-1052410"></A>
If you want to remove a node from a cluster, you must log into the Admin Interface for that node, go to its host configuration page and click the <code>
leave</code>
 button. </Body>
<Body>
<A ID="pgfId-1052943"></A>
Before you remove a node from a cluster, make sure it is not hosting any forests for the cluster (the forest summary page shows this information) or is not acting as a failover host for any forests. You must resolve any forest dependencies with other hosts before you can remove a host from the cluster; the Admin Interface will not allow you to remove a host from the cluster if there are other hosts depending on it, and it will attempt to help you to resolve the dependencies. That might involve removing the host as a failover host, detaching the forest from the database, or assigning the forest to another d-node. For details about managing forests, see the <Emphasis>
Administrator's Guide</Emphasis>
.</Body>
<Body>
<A ID="pgfId-1052704"></A>
Perform the following basic procedure to remove a host from a cluster:</Body>
<Number1>
<A ID="pgfId-1052697"></A>
Access the Admin Interface for the node you want to remove from the cluster.</Number1>
<NumberList>
<Number>
<A ID="pgfId-1052708"></A>
Navigate to the host configuration page for the host, either through the tree menu (the Configure tab under Hosts &gt; <Emphasis>
host_name</Emphasis>
) or from one of the summary pages.</Number>
<Number>
<A ID="pgfId-1052721"></A>
To leave the cluster, click the <code>
leave</code>
 button. The <code>
leave</code>
 button only appears when you are using the Admin Interface on which the host machine is running. On the Admin Interface on other nodes in the cluster, there is an <code>
admin</code>
 button, which is a link to open the Admin Interface running on that host.</Number>
<Number>
<A ID="pgfId-1052734"></A>
On the Leave Cluster page, click OK to confirm. MarkLogic Server on that host will restart, and the host is removed from the cluster.</Number>
</NumberList>
<Body>
<A ID="pgfId-1052738"></A>
At this point, the installation process will begin again (although you will not have to reenter the license key information). You can choose to join the cluster again, join another cluster, or skip the cluster installation and install as a stand-alone host.</Body>
<Heading-2>
<A ID="pgfId-1052411"></A>
<A ID="21237"></A>
Upgrading a Cluster to a New Maintenance Release of MarkLogic Server</Heading-2>
<Body>
<A ID="pgfId-1052418"></A>
Each host in a MarkLogic Server cluster must run the same version of the MarkLogic software. Therefore, if you install a maintenance release, you need to install it on all of the hosts in the cluster. </Body>
<Note>
<A ID="pgfId-1059327"></A>
The security database and the schemas database must be on the same host, and that host should be the first host you upgrade when upgrading a cluster.</Note>
<Body>
<A ID="pgfId-1052750"></A>
The upgrade installation is relatively quick, and should require only a small amount of cluster down time. It does require each host to shut down, uninstall, reinstall, and start up, however.</Body>
<Body>
<A ID="pgfId-1052745"></A>
For a more detailed upgrade procedure, see the <Emphasis>
Installation Guide</Emphasis>
. The general procedure for upgrading a cluster is as follows:</Body>
<Number1>
<A ID="pgfId-1052746"></A>
Download the maintenance release of MarkLogic Server you plan on installing. Make sure to download the correct release for your platform.</Number1>
<NumberList>
<Number>
<A ID="pgfId-1052757"></A>
Shut down all of the hosts in the cluster. For example, on the Cluster Status page, click the Shutdown button.</Number>
<Number>
<A ID="pgfId-1052760"></A>
After the hosts have finished shutting down, uninstall each instance of MarkLogic Server (from the Add/Remove Programs Control Panel on Windows, with <code>
rpm -e MarkLogic</code>
 on Red Hat Linux, and with <code>
pkgrm MARKlogic</code>
 on Solaris). For details, see the <Emphasis>
Installation Guide</Emphasis>
.</Number>
<Number>
<A ID="pgfId-1059310"></A>
Install the new release of MarkLogic Server on each host (with the installer on Windows, <code>
rpm -i</code>
 on Red Hat Linux, <code>
pkgadd MARKlogic</code>
 on Solaris). For details, see the <Emphasis>
Installation Guide</Emphasis>
.</Number>
<Number>
<A ID="pgfId-1059317"></A>
Start up MarkLogic Server on the machine that hosts the security database. </Number>
<Number>
<A ID="pgfId-1059321"></A>
Start up MarkLogic Server on all of the other hosts.</Number>
<Number>
<A ID="pgfId-1052813"></A>
Access the Admin Interface on the machine in which the security database forest is hosted.</Number>
<Number>
<A ID="pgfId-1052814"></A>
When prompted, enter the username and password. The license agreement page appears.</Number>
<Number>
<A ID="pgfId-1052827"></A>
Accept the license agreement, either for that host (Accept button) or for all of the hosts in the cluster (Accept for Cluster button). If you choose the Accept for Cluster button, a summary screen appears showing all of the hosts in the cluster. Click the Accept for Cluster button to confirm acceptance (all of the hosts must be started in order to accept for the cluster). </Number>
</NumberList>
<Note>
<A ID="pgfId-1052830"></A>
Accepting this license agreement is optional. However, to begin using MarkLogic Server, you must accept the terms and conditions outlined in the license agreement. If you have executed a written software license with MarkLogic Corporation, the agreement displayed references that written agreement.</Note>
<NumberList>
<Number>
<A ID="pgfId-1052845"></A>
If you accepted the license just for the one host in the previous step, you must go to all of the Admin Interface for all of the other hosts and accept the license for each host before each host can operate.</Number>
</NumberList>
<Body>
<A ID="pgfId-1052822"></A>
This concludes the upgrade, and the upgraded cluster is now available to accept requests.</Body>
</XML>
