<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="scheduling_tasks.css" type="text/css" charset="UTF-8"?>
<XML>
<TITLE> </TITLE><Heading-1>
<A ID="pgfId-1038002"></A>
<A ID="44210"></A>
Scheduling Tasks</Heading-1>
<pagenum>
<A ID="pgfId-1048954"></A>
276</pagenum>
<Body>
<A ID="pgfId-1038003"></A>
This chapter describes how to schedule tasks that execute XQuery main modules at a predefined date/time or interval. The following topics are included:</Body>
<Body-bullet>
<A ID="pgfId-1042529"></A>
<A href="scheduling_tasks.xml#id(20028)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Understanding Scheduled Tasks</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1042538"></A>
<A href="scheduling_tasks.xml#id(99661)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Scheduling a Module for Invocation</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1048463"></A>
<A href="scheduling_tasks.xml#id(60248)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Selecting a Task Type</Hyperlink>
</A></Body-bullet>
<Body>
<A ID="pgfId-1049575"></A>
This chapter describes how to use the Admin Interface to manage scheduled tasks. For details on how to manage scheduled tasks programmatically, see <A href="../AdminAPI/maintenance.xml#id(47962)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Group Maintenance Operations</Hyperlink>
</A> in the <Emphasis>
Scripting Administrative Tasks Guide</Emphasis>
.</Body>
<Heading-2>
<A ID="pgfId-1046808"></A>
<A ID="20028"></A>
Understanding Scheduled Tasks</Heading-2>
<Body>
<A ID="pgfId-1046741"></A>
MarkLogic Server allows you to schedule the execution of XQuery main modules. The ability to schedule module execution is useful for:</Body>
<Body-bullet>
<A ID="pgfId-1046742"></A>
Loading content. For example, periodically checking for new content from an external data source, such as a web site, web service, etc. </Body-bullet>
<Body-bullet>
<A ID="pgfId-1048504"></A>
Synchronizing content. For example, when MarkLogic is used as a metadata repository, you might want to periodically check for changed data.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1048505"></A>
Delivering batches of content: For example, initiate an RSS feed, hourly or daily.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1048583"></A>
Delivering aggregated alerts, either hourly or daily.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1048584"></A>
Delivering reports, either daily, weekly, or monthly.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1048585"></A>
Polling for the completion of an asynchronous process, such as the creation of a PDF file</Body-bullet>
<Body>
<A ID="pgfId-1046755"></A>
Tasks can be scheduled to run at a particular time on a particular date, or at a specified interval. MarkLogic Server attempts to place the task on the task server's queue at the specified time, but the actual execution of the task might not start at this time. If the queue is full, the task fails and will not be re-tried until the next scheduled interval. </Body>
<Heading-2>
<A ID="pgfId-1046785"></A>
<A ID="99661"></A>
Scheduling a Module for Invocation</Heading-2>
<Body>
<A ID="pgfId-1047284"></A>
To schedule a module for invocation at a particular date/time or interval, do the following:</Body>
<Number1>
<A ID="pgfId-1047208"></A>
Click the Groups icon in the left frame.</Number1>
<NumberList>
<Number>
<A ID="pgfId-1047209"></A>
Click on the group in which you want to schedule a task (for example, Default).</Number>
<Number>
<A ID="pgfId-1047210"></A>
Click the Scheduled Tasks icon on the left tree menu.</Number>
<Number>
<A ID="pgfId-1047672"></A>
Click on the Create tab to bring up the Schedule a Task page</Number>
<Number>
<A ID="pgfId-1047223"></A>
Specify the URI for the module to invoke in the Task Path field. The task path must begin with a forward slash (/) and cannot contain a question mark '?', colon ':' or pound '#' character. </Number>
<Number>
<A ID="pgfId-1047694"></A>
In the Task Root field, specify the root directory (files system) or URI root (database) that contains the module. For example, if the module is located in the file system under <code>
MarkLogic/Docs</code>
, specify <code>
Docs</code>
. </Number>
<Number>
<A ID="pgfId-1047707"></A>
In the Task Type field, select one of the task types described in <A href="scheduling_tasks.xml#id(60248)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Selecting a Task Type' on page&#160;273</A>.</Number>
<Number>
<A ID="pgfId-1047784"></A>
In the Database field, select the database on which to invoke the module.</Number>
<Number>
<A ID="pgfId-1047801"></A>
In the Task Modules field, select either the file system or database that contains the module specified in the Task Path field.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1047887"></A>
If Task Modules is set to (file system), then place the module in the directory specified by Task Root. For example, in the configuration shown below, you would place the Scheduler_test.xqy file in the <code>
MarkLogic/Docs </code>
directory.</Body-indent>
<Body-indent>
<A ID="pgfId-1048036"></A>
If Task Modules is set to a database, then load the module into that database under the URI root specified by Task Root. For example, if the configuration shown below specified the <code>
Documents</code>
 database in the Task Modules field, you could use the xdmp:document-load function to load the module with the following URI option: </Body-indent>
<Code>
<A ID="pgfId-1047935"></A>
&lt;uri&gt;Docs/Scheduler_test.xqy&lt;/uri&gt;</Code>
<NumberList>
<Number>
<A ID="pgfId-1048138"></A>
In the Task User and Task Host fields, specify the user with permission to invoke the task and the host computer on which the task is to be invoked. If no host is specified, then the task runs on all hosts.</Number>
</NumberList>
<Note>
<A ID="pgfId-1048152"></A>
The user specified in the Task User field must have the privileges required to execute the functions used in the module. See <A href="exec_privs.xml#id(84238)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Appendix B: Pre-defined Execute Privileges' on page&#160;281</A> for the full list of execute privileges.</Note>
<Body-indent>
<A ID="pgfId-1048113"></A>
Example of a Scheduled Task configuration:</Body-indent>
<Body>
<A ID="pgfId-1047884"></A>
<IMAGE xml:link="simple" href="images/scheduled_task_test.gif" show="embed" actuate="auto"/>
</Body>
<Heading-2>
<A ID="pgfId-1047446"></A>
<A ID="60248"></A>
Selecting a Task Type</Heading-2>
<Body>
<A ID="pgfId-1047728"></A>
You can select one of the date/time or interval scheduling options described in this section as your task type. </Body>
<Body>
<A ID="pgfId-1048690"></A>
The interval scheduling options that operate on elapsed time are:</Body>
<Body-bullet>
<A ID="pgfId-1048324"></A>
<A href="scheduling_tasks.xml#id(90542)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Scheduling Per Minute</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1048369"></A>
<A href="scheduling_tasks.xml#id(87704)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Scheduling Per Hour</Hyperlink>
</A></Body-bullet>
<Body>
<A ID="pgfId-1048703"></A>
The date/time scheduling options that operate on calendar time are:</Body>
<Body-bullet>
<A ID="pgfId-1048384"></A>
<A href="scheduling_tasks.xml#id(25299)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Scheduling Per Day and Time</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1048399"></A>
<A href="scheduling_tasks.xml#id(36103)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Scheduling Per Week, Day, and Time</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1048414"></A>
<A href="scheduling_tasks.xml#id(62121)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Scheduling Per Month, Day, and Time</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1048429"></A>
<A href="scheduling_tasks.xml#id(84359)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Scheduling One Invocation on a Calendar Date and Time</Hyperlink>
</A></Body-bullet>
<Note>
<A ID="pgfId-1048715"></A>
The date/time options are scheduled in terms of the local time designated by the server's clock. This means that, in regions that recognize daylight savings time, a scheduling interval of 24 hours is not the same as a once-per-day at a particular time scheduling interval.</Note>
<Heading-3>
<A ID="pgfId-1048223"></A>
<A ID="90542"></A>
Scheduling Per Minute</Heading-3>
<Body>
<A ID="pgfId-1047469"></A>
If you select minutely task type, specify how many minutes are to elapse between each invocation of the module. For example, to invoke the module every 5 minutes (or as soon as possible thereafter, if the server is overloaded), enter:</Body>
<Body>
<A ID="pgfId-1047172"></A>
<IMAGE xml:link="simple" href="images/task_minutely2.gif" show="embed" actuate="auto"/>
</Body>
<Heading-3>
<A ID="pgfId-1048241"></A>
<A ID="87704"></A>
Scheduling Per Hour</Heading-3>
<Body>
<A ID="pgfId-1047462"></A>
If you select hourly task type, specify how many hours are to elapse between each invocation of the module. The Task Minute setting specifies how many minutes after the hour the module is to be invoked. Note that the Task Minute setting does not add to the interval.</Body>
<Body>
<A ID="pgfId-1048749"></A>
For example, to invoke the module every 2 hours at 30 minutes past the hour (or as soon as possible thereafter, if the server is overloaded), enter:</Body>
<Body>
<A ID="pgfId-1047186"></A>
<IMAGE xml:link="simple" href="images/task_hourly.gif" show="embed" actuate="auto"/>
</Body>
<Body>
<A ID="pgfId-1048771"></A>
If the current time is 2:15pm, the task will run at 2:30, 4:30pm, 6:30pm, 8:30pm, and so on.</Body>
<Heading-3>
<A ID="pgfId-1048255"></A>
<A ID="25299"></A>
Scheduling Per Day and Time</Heading-3>
<Body>
<A ID="pgfId-1047504"></A>
If you select daily task type, specify how many days are to elapse between each invocation of the module and the time of day (in 24:00 notation) of the invocation.</Body>
<Body>
<A ID="pgfId-1048799"></A>
For example, to invoke the module every three days at 12:00pm, enter:</Body>
<Body>
<A ID="pgfId-1047340"></A>
<IMAGE xml:link="simple" href="images/task_daily.gif" show="embed" actuate="auto"/>
</Body>
<Heading-3>
<A ID="pgfId-1048282"></A>
<A ID="36103"></A>
Scheduling Per Week, Day, and Time</Heading-3>
<Body>
<A ID="pgfId-1047200"></A>
If you select weekly task type, specify how many weeks are to elapse between each invocation of the module, as well as one or more days of the week and time (in 24:00 notation) of the invocation.</Body>
<Body>
<A ID="pgfId-1048810"></A>
For example, to invoke the module every other week, on Friday, at 5:00pm, enter:</Body>
<Body>
<A ID="pgfId-1047356"></A>
<IMAGE xml:link="simple" href="images/task_weekly.gif" show="embed" actuate="auto"/>
</Body>
<Heading-3>
<A ID="pgfId-1048296"></A>
<A ID="62121"></A>
Scheduling Per Month, Day, and Time</Heading-3>
<Body>
<A ID="pgfId-1047372"></A>
If you select monthly task type, specify how many months are to elapse between each invocation of the module, as well as the day of the month and time (in 24:00 notation) of the invocation.</Body>
<Body>
<A ID="pgfId-1048851"></A>
For example, to invoke the module every three months, on the 15th day of the month, at 8:00am, enter:</Body>
<Body>
<A ID="pgfId-1047379"></A>
<IMAGE xml:link="simple" href="images/task_monthly.gif" show="embed" actuate="auto"/>
</Body>
<Heading-3>
<A ID="pgfId-1048332"></A>
<A ID="84359"></A>
Scheduling One Invocation on a Calendar Date and Time</Heading-3>
<Body>
<A ID="pgfId-1047386"></A>
If you select once task type, specify the calendar day (month/day/year) and time (in 24:00 notation) of the invocation.</Body>
<Body>
<A ID="pgfId-1048919"></A>
For example, to invoke the module on May 2, 2009 at 6:00pm, enter:</Body>
<Body>
<A ID="pgfId-1047393"></A>
<IMAGE xml:link="simple" href="images/task_once.gif" show="embed" actuate="auto"/>
</Body>
</XML>
