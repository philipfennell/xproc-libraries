<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="backup_restore.css" type="text/css" charset="UTF-8"?>
<XML>
<TITLE> </TITLE><Heading-1>
<A ID="pgfId-1042374"></A>
<A ID="93243"></A>
Backing Up and Restoring a Database</Heading-1>
<pagenum>
<A ID="pgfId-1044397"></A>
165</pagenum>
<Body>
<A ID="pgfId-1038003"></A>
MarkLogic Server provides a facility to make a consistent backup of a database. This section describes the backup and restore architecture and provides procedures for backing up and restoring a database. The following topics are included:</Body>
<Body-bullet>
<A ID="pgfId-1038007"></A>
<A href="backup_restore.xml#id(95335)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Backup and Restore Overview</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1038011"></A>
<A href="backup_restore.xml#id(67513)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Backing Up a Database</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1038015"></A>
<A href="backup_restore.xml#id(50557)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Restoring a Database</Hyperlink>
</A></Body-bullet>
<Heading-2>
<A ID="pgfId-1038022"></A>
<A ID="95335"></A>
Backup and Restore Overview</Heading-2>
<Body>
<A ID="pgfId-1038023"></A>
Database backup and restore operations in MarkLogic Server are distributed over all of the data nodes in a cluster (that is, all of the nodes that contain forests), and provide consistent database-level backups and restores. </Body>
<Body>
<A ID="pgfId-1042642"></A>
The directory you specify for a backup or restore operation must exist on each data node associated with the database (it can be either a shared or unshared directory). For example, if you have a data node on Host1 with forests F1 and F2, and another data node on Host2 with forests F3 and F4, then the backup directory you specify must exist on both Host1 and Host2. The following figure shows such a configuration, where the Schemas and Security databases have forests F5 and F6 respectively, and they are also attached to Host1.</Body>
<Body-indent>
<A ID="pgfId-1043019"></A>
<IMAGE xml:link="simple" href="backup_restore-1.gif" show="embed" actuate="auto"/>
</Body-indent>
<Heading-3>
<A ID="pgfId-1042283"></A>
Consistent, Database-Level Backup</Heading-3>
<Body>
<A ID="pgfId-1042287"></A>
By default, when you back up a database you backup everything associated with it, including the following:</Body>
<Body-bullet>
<A ID="pgfId-1042653"></A>
The configuration files.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1042658"></A>
The Security database, including all of its forests.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1042659"></A>
The Schemas database, including all of its forests.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1042669"></A>
All of the forests of the database you are backing up.</Body-bullet>
<Body>
<A ID="pgfId-1042654"></A>
If you choose to back up all forests, you will have a backup that you can restore to the exact same state as when the backup begins copying files. </Body>
<Body>
<A ID="pgfId-1042673"></A>
You can also backup any individual forests that you choose, choosing only the ones you need to backup. These forest-level backups are consistent for the data in the forest and any other forests included in the backup, but might not be consistent with changes that occur in other forests not included in the backup.</Body>
<Body>
<A ID="pgfId-1042676"></A>
You can also choose not to backup the Security and Schemas databases. While having backups of these databases that are synchronized with the database backups is important to get the exact same view of the system as when the backup began, you might have separate processes for backing up these databases that can ensure proper consistency. For example, if they do not change frequently, you may only need to back them up when they change.</Body>
<Body>
<A ID="pgfId-1042683"></A>
The database-level backup and restore in MarkLogic Server provides the flexibility for you to decide how much or how little you want to backup or restore. The choices you make depend on the amount of change in your system and your unique backup and restore requirements.</Body>
<Note>
<A ID="pgfId-1044385"></A>
Restoring the Security database will require a restart of MarkLogic Server.</Note>
<Heading-3>
<A ID="pgfId-1042288"></A>
Admin Interface</Heading-3>
<Body>
<A ID="pgfId-1042292"></A>
You use the Admin Interface to initiate backup and restore operations. Use the Backup/Restore tab for each database configured in your system to initiate backup and restore operations. For specific procedures for backup and restore operations, see <A href="backup_restore.xml#id(67513)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Backing Up a Database' on page&#160;157</A> and <A href="backup_restore.xml#id(50557)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Restoring a Database' on page&#160;164</A>.</Body>
<Heading-3>
<A ID="pgfId-1042293"></A>
Backup and Restore Transactions</Heading-3>
<Body>
<A ID="pgfId-1042297"></A>
Backup and restore operations are transactional and therefore guarantee a consistent view of the data. They do not lock the database, however. Therefore, if the data in a database changes after a backup or restore operation begins but before it completes, those changes are not reflected in the backup or restore operation. Similarly, changes to the Security and Schemas databases during a backup or restore operation are allowed, but will not be reflected in the backup or restore.</Body>
<Body>
<A ID="pgfId-1042594"></A>
Database and Forest administrative tasks such as drop, clear, and delete cannot take place during a backup; any such operation is queued up and will initiate after the backup transaction has completed.</Body>
<Heading-3>
<A ID="pgfId-1042300"></A>
<A ID="62190"></A>
Backup Directory Structure</Heading-3>
<Body>
<A ID="pgfId-1053027"></A>
When you back up a database, you specify a backup directory. That directory must exist on each host in your configuration, and must be readable and writable by the user running MarkLogic Server (by default <code>
daemon</code>
 on UNIX and the local System user on Windows). Because of the importance of database backup integrity, MarkLogic recommends backing up to a reliable filesystem. The backup directory structure for each host is the same, except that the forests are only backed up on the host from which they are served.</Body>
<Body>
<A ID="pgfId-1042701"></A>
Below the specified backup directory, a subdirectory is created with a name based on the date when the backup begins. Each of these subdirectories contain one backup. The following is the basic backup directory structure.</Body>
<Code>
<A ID="pgfId-1044367"></A>
&lt;specified_backup_dir&gt;/
&#160;&#160;&#160;&lt;date_1&gt;-1/
&#160;&#160;&#160;&#160;&#160;&#160;*.xml
&#160;&#160;&#160;&#160;&#160;&#160;BackupTag.txt
&#160;&#160;&#160;&#160;&#160;&#160;Forests/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;security_forest_1&gt;/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;forest_files_and_directories&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;security_forest_<Emphasis>
n</Emphasis>
&gt;/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;forest_files_and_directories&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;schemas_forest_1&gt;/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;forest_files_and_directories&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;schemas_forest_<Emphasis>
n</Emphasis>
&gt;/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;forest_files_and_directories&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;database_forest_1&gt;/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;forest_files_and_directories&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;database_forest_<Emphasis>
n</Emphasis>
&gt;/
&#160;&#160;&#160;&lt;date_1&gt;-<Emphasis>
n</Emphasis>
/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;<Emphasis>
backup_directory structure</Emphasis>
&gt;
&#160;&#160;&#160;&lt;date_<Emphasis>
n</Emphasis>
&gt;-1/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;<Emphasis>
backup_directory structure</Emphasis>
&gt;
&#160;&#160;&#160;&lt;date_<Emphasis>
1</Emphasis>
&gt;-<Emphasis>
n</Emphasis>
/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;<Emphasis>
backup_directory structure</Emphasis>
&gt;</Code>
<Body>
<A ID="pgfId-1044018"></A>
For example, if you back up a database to the <code>
/space/backups</code>
 directory on September 1, 2004, a directory structure similar to the following is created:</Body>
<Code>
<A ID="pgfId-1044019"></A>
/space/backups
&#160;&#160;&#160;20040901-1/
&#160;&#160;&#160;&#160;&#160;&#160;*.xml
&#160;&#160;&#160;&#160;&#160;&#160;BackupTag.txt
&#160;&#160;&#160;&#160;&#160;&#160;Forests/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Documents/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Label
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;000001e1/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Journals/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Schemas/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Label
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;000001e1/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Journals/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Security/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Label
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;000001e1/
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Journals/</Code>
<Heading-3>
<A ID="pgfId-1042388"></A>
Phases of Backup or Restore Operation</Heading-3>
<Body>
<A ID="pgfId-1042444"></A>
Backup and restore operations are divided into the following phases:</Body>
<Body-bullet>
<A ID="pgfId-1042445"></A>
Validation</Body-bullet>
<Body-bullet>
<A ID="pgfId-1042449"></A>
Copy</Body-bullet>
<Body-bullet>
<A ID="pgfId-1042450"></A>
Synchronization</Body-bullet>
<Body>
<A ID="pgfId-1042456"></A>
The following figure shows the phases of a backup or restore operation:</Body>
<DIV>
<IMAGE xml:link="simple" href="backup_restore-2.gif" show="embed" actuate="auto"/>
</DIV>
<Heading-4>
<A ID="pgfId-1042575"></A>
Validation Phase</Heading-4>
<Body>
<A ID="pgfId-1042579"></A>
The validation phase is where the backup directories are checked to make sure that all of the needed files exist and that all of the needed backup directories exist and are writable. For backup operations, they are checked for sufficient disk space. For restore operations, the configuration files are read and the other backup files are checked to make sure they appear to be valid. The validation phase does not actually write any data and is completely asynchronous. </Body>
<Heading-4>
<A ID="pgfId-1042582"></A>
Copy Phase</Heading-4>
<Body>
<A ID="pgfId-1042580"></A>
The copy phase is where the files are actually copied to or from the backup directory. The configuration files are copied at the beginning of the backup operation, and at this point a timestamp is written to the <code>
BackupTag.txt</code>
 file. The copy phase that might take a significant amount of time, depending on the size of the database. The start of the copy phase starts a transaction; if the transaction fails on a restore operation, the database remains unchanged from its original state.</Body>
<Heading-4>
<A ID="pgfId-1042588"></A>
Synchronization Phase</Heading-4>
<Body>
<A ID="pgfId-1042589"></A>
During a backup or restore operation, the synchronization phase is where cleanup tasks such as deleting temporary files takes place, leaving the database in a consistent state. During a restore operation, the synchronization phase also takes the old version of the database offline and replaces it with the newly restored version.</Body>
<Note>
<A ID="pgfId-1042609"></A>
Any 'cold' administrative tasks (tasks that require a server restart) will cause any backup or restore operations to fail. Do not perform any 'cold' administrative tasks during a backup or restore operation. For a list of 'hot' and 'cold' operations, see <A href="hotcold.xml#id(84238)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Appendix A: ‘Hot' versus ‘Cold' Admin Tasks' on page&#160;277</A>.</Note>
<Heading-3>
<A ID="pgfId-1042443"></A>
Notes about Backup and Restore Operations</Heading-3>
<Body>
<A ID="pgfId-1042393"></A>
This section provides notes and restrictions about backing up and restoring MarkLogic Server databases.</Body>
<Body-bullet>
<A ID="pgfId-1042394"></A>
The backup files are platform specific--backups on a given platform should only be restored onto the same platform. This is true for both database and forest backups.</Body-bullet>
<Body-bullet>
<A ID="pgfId-1042782"></A>
You can restore an individual forest using a database backup by unchecking all forests except the one you want to restore on the Confirm Restore screen (see step <A href="backup_restore.xml#id(57053)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
7</Hyperlink>
</A> in <A href="backup_restore.xml#id(50557)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Restoring a Database' on page&#160;164</A>). </Body-bullet>
<Body-bullet>
<A ID="pgfId-1044080"></A>
We recommend using the database-level backup/restore, not the forest-level backup/restore. If you do use the forest-level backup/restore, note that you cannot restore a backup created with the forest-level backup as a database-level restore operation; forest-level backups created with the forest backup/restore utility must be restored from the forest restore utility. For details, see <A href="forests.xml#id(13805)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Restoring a Forest' on page&#160;183</A>. </Body-bullet>
<Body-bullet>
<A ID="pgfId-1048544"></A>
The restore operation is designed to restore into a database that has the same configuration settings as the one that was backed up, but it neither requires nor checks that the configurations are the same. The restore operation must occur on a database that has its configuration defined. Also, the restore operation does not change the database configuration files. Because the configuration files hold all of the database configuration information such as index options, fragmentation, range indexes, and so on, the restored database will take on the configuration information of the database to which it is restored. If this configuration information is different from the database that was backed up, and if reindexing is enabled, the database will reindex to the new configuration after the restore completes. </Body-bullet>
<Body-bullet>
<A ID="pgfId-1053066"></A>
If a databases backup is canceled, the in-flight backup is deleted. A database backup can be canceled by clicking the cancel button for the backup in the database status page in the Admin Interface, by a forest in the database being restarted (including if it is restarted due to failing over), by the host or cluster being restarted (either from the Admin Interface or from the <code>
xdmp:restart</code>
 command), or by errors in the backup (such as out-of-disk space errors). The process of deleting the in-flight backup during a clean restart might take some time, which can increase the time it takes to restart MarkLogic Server. If you are restarting using the startup scripts (<code>
/etc/init.d/MarkLogic</code>
 on UNIX systems and the control panel on Windows systems), then the script will delete as much of the backup as it can in 20 seconds; if any backup is in-flight during these types of system shutdown or restart operations, then you should manually remove them after the operation.</Body-bullet>
<Heading-2>
<A ID="pgfId-1035177"></A>
<A ID="67513"></A>
Backing Up a Database</Heading-2>
<Body>
<A ID="pgfId-1051838"></A>
You can either initiate a database backup immediately or you can schedule a backup to occur in the future with the following procedures:</Body>
<Body-bullet>
<A ID="pgfId-1051843"></A>
<A href="backup_restore.xml#id(51602)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Backing Up a Database Immediately</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1051851"></A>
<A href="backup_restore.xml#id(65343)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Scheduling a Database Backup</Hyperlink>
</A></Body-bullet>
<Heading-3>
<A ID="pgfId-1051839"></A>
<A ID="51602"></A>
Backing Up a Database Immediately</Heading-3>
<Body>
<A ID="pgfId-1042356"></A>
Perform the following steps to initiate a database backup:</Body>
<Number1>
<A ID="pgfId-1042357"></A>
Log into the Admin Interface as a user with the <code>
admin</code>
 role.</Number1>
<NumberList>
<Number>
<A ID="pgfId-1042358"></A>
Click the Databases link in the left menu of the Admin Interface.</Number>
<Number>
<A ID="pgfId-1042309"></A>
Click the database name for the database you want to back up, either from the tree menu or on the summary page.</Number>
<Number>
<A ID="pgfId-1042310"></A>
Click the Backup/Restore tab. The Backup/Restore screen appears.</Number>
<Number>
<A ID="pgfId-1042311"></A>
Enter the directory to which you want the database backed up in the Backup to directory field.</Number>
</NumberList>
<Note>
<A ID="pgfId-1042892"></A>
The directory path must exist on all hosts that serve any forests in the database.</Note>
<Body-indent>
<A ID="pgfId-1043989"></A>
<IMAGE xml:link="simple" href="images/backup_to.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1042893"></A>
Click OK. </Number>
<Number>
<A ID="pgfId-1044108"></A>
If an invalid directory error appears, then the directory does not exist or is not writable. Create the directory with the proper permissions (readable and writable by the user running MarkLogic Server, by default <code>
daemon</code>
 on UNIX and the local System user on Windows) and click OK again.</Number>
<Number>
<A ID="pgfId-1042894"></A>
The Confirm Backup screen appears and lists all the forest selected for back up.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1042795"></A>
<IMAGE xml:link="simple" href="images/confirm_backup.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1042330"></A>
Click OK to begin the backup immediately, or deselect forests that you do not want to back up.</Number>
</NumberList>
<Note>
<A ID="pgfId-1042331"></A>
If you deselect any of the forests to backup, you might not have a completely consistent view of the database to restore. Only deselect any forests if you are sure you understand the implications of what you are backing up. To guarantee the exact same view of the database, backup all of the forests associated with the database, including the Schemas and Security database forests.</Note>
<NumberList>
<Number>
<A ID="pgfId-1042332"></A>
After the backup is underway, the Admin Interface redirects you to the Database Status page. </Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1042816"></A>
<IMAGE xml:link="simple" href="images/backup_status.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1042815"></A>
You can refresh the Database Status screen to view the progress of the backup.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1042823"></A>
<IMAGE xml:link="simple" href="images/backup_complete.gif" show="embed" actuate="auto"/>
</Body-indent>
<EndList-root>
<A ID="pgfId-1042341"></A>
The Backups table lists when the backup was started, provides an estimate of the amount of time left, and lists other status information about the backup operation. When the backup is complete, the entry in the backup table disappears. </EndList-root>
<Body>
<A ID="pgfId-1047891"></A>
If the status for any of the forests was something besides 'completed,' then an error occurred during the backup operation. Check the <Emphasis>
Mark_Logic_Data</Emphasis>
<code>
/Logs/ErrorLog.txt</code>
 file for any errors, correct them, and try the backup operation again.</Body>
<Heading-3>
<A ID="pgfId-1051861"></A>
<A ID="65343"></A>
Scheduling a Database Backup</Heading-3>
<Body>
<A ID="pgfId-1051862"></A>
You can schedule database backups to periodically back up a database. You can schedule backups to occur daily, weekly, monthly, or you can schedule a one-time backup. You can create as many scheduled backups as you want. To create a scheduled backup, perform the following steps using the Admin Interface:</Body>
<Number1>
<A ID="pgfId-1051863"></A>
Click the Databases icon on the left tree menu.</Number1>
<NumberList>
<Number>
<A ID="pgfId-1051864"></A>
Select the database for which you want to schedule a backup, either on the tree menu or from the Database Summary page. The Database Configuration page appears.</Number>
<Number>
<A ID="pgfId-1051865"></A>
Click the Scheduled Backup link in the tree menu for the database. The Scheduled Backup Configuration page appears. </Number>
<Number>
<A ID="pgfId-1051866"></A>
On the Scheduled Backup Configuration page, you can delete any existing scheduled backups if you no longer need them.</Number>
<Number>
<A ID="pgfId-1051867"></A>
Click the Create tab. The Create Scheduled Backups page appears:</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1051871"></A>
<IMAGE xml:link="simple" href="images/database-sched-backup.gif" show="embed" actuate="auto"/>
</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1051872"></A>
Enter the absolute path to the backup directory. The backup directory must have permissions such that the MarkLogic Server process can read and write to it.</Number>
<Number>
<A ID="pgfId-1051876"></A>
Choose a scheduled or one-time for the backup type:</Number>
</NumberList>
<Body-bullet-2>
<A ID="pgfId-1052207"></A>
For minutely, enter how many minutes between each backup. </Body-bullet-2>
<Body-bullet-2>
<A ID="pgfId-1052299"></A>
For hourly, enter how many hours between each backup. The Backup Minute setting specifies how many minutes after the hour the backup is to start. Note that the Backup Minute setting does not add to the interval.</Body-bullet-2>
<Body-bullet-2>
<A ID="pgfId-1052224"></A>
For daily, enter how many days between each backup and the time of day. </Body-bullet-2>
<Body-bullet-2>
<A ID="pgfId-1052231"></A>
For weekly, enter how many weeks between each backup, check one or more days of the week, and the time of day for the backup to start. </Body-bullet-2>
<Body-bullet-2>
<A ID="pgfId-1052238"></A>
For monthly, enter how many months between each backup, select one day of the month (1-31), and the time of day for the backup to start. </Body-bullet-2>
<Body-bullet-2>
<A ID="pgfId-1052245"></A>
For one-time, enter the backup start date in MM/DD/YYYY notation (for example, 07/29/2009 for July 29, 2009) and time in 24:00 notation.</Body-bullet-2>
<NumberList>
<Number>
<A ID="pgfId-1051877"></A>
Enter the time of day to start the backup.</Number>
<Number>
<A ID="pgfId-1051934"></A>
Enter the maximum number of backups to keep. When you reach the specified maximum number of backups, the next backup will delete the oldest backup. Specify 0 to keep an unlimited number of backups. </Number>
<Number>
<A ID="pgfId-1051946"></A>
Choose whether you want the backups to include the security database, the schemas database, and/or the triggers database for this scheduled backup.</Number>
<Number>
<A ID="pgfId-1051935"></A>
Click OK to create the scheduled backup.</Number>
</NumberList>
<EndList-root>
<A ID="pgfId-1051879"></A>
The backups will automatically start according to the specified schedule.</EndList-root>
<Heading-2>
<A ID="pgfId-1042098"></A>
<A ID="50557"></A>
Restoring a Database</Heading-2>
<Body>
<A ID="pgfId-1042099"></A>
To restore an entire database from a backup, perform the following steps:</Body>
<Number1>
<A ID="pgfId-1042841"></A>
Log into the Admin Interface as a user with the <code>
admin</code>
 role.</Number1>
<NumberList>
<Number>
<A ID="pgfId-1042842"></A>
Click the Databases link in the left menu of the Admin Interface.</Number>
<Number>
<A ID="pgfId-1042843"></A>
Click the database name for the database you want to restore, either on the tree menu or on the summary page. This database should have the same configuration settings (index options, fragmentation, range indexes) as the one that was backed up.</Number>
<Number>
<A ID="pgfId-1042844"></A>
Click the Backup/Restore tab. The Backup/Restore screen appears.</Number>
<Number>
<A ID="pgfId-1042845"></A>
Enter the directory in which the back up exists in the Restore from directory field.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1042865"></A>
<IMAGE xml:link="simple" href="images/restore_from.gif" show="embed" actuate="auto"/>
</Body-indent>
<Note>
<A ID="pgfId-1042924"></A>
If you enter a directory that contains multiple backups of the same database, the latest one is used. If you want to choose a particular backup to restore, enter the <Emphasis>
date_stamp</Emphasis>
 subdirectory corresponding to the backup you want to restore. For details of the directory structure, see <A href="backup_restore.xml#id(62190)" xml:link="simple" show="replace" actuate="user" CLASS="XRef">'Backup Directory Structure' on page&#160;154</A>.</Note>
<NumberList>
<Number>
<A ID="pgfId-1042866"></A>
Click OK.</Number>
<Number>
<A ID="pgfId-1042905"></A>
<A ID="57053"></A>
The Confirm restore screen appears and lists all the forest selected for restoring.</Number>
</NumberList>
<Body-indent>
<A ID="pgfId-1042908"></A>
<IMAGE xml:link="simple" href="images/confirm_restore.gif" show="embed" actuate="auto"/>
</Body-indent>
<Body-indent>
<A ID="pgfId-1042909"></A>
The Confirm restore screen also lists the date the backup was performed and the server version used for the backup you selected.</Body-indent>
<NumberList>
<Number>
<A ID="pgfId-1042920"></A>
By default, all of the forests associated with a database are checked to restore. If you do not want to restore all of the forests, deselect any forests you do not want to restore.</Number>
</NumberList>
<Note>
<A ID="pgfId-1042940"></A>
If you deselect any of the forests to restore, you might not be restoring a completely consistent view of the database. Only deselect any forests if you are sure you understand the implications of what you are restoring. To guarantee the exact same view of the database, restore all of the forests associated with the database, including the Schemas and Security database forests.</Note>
<NumberList>
<Number>
<A ID="pgfId-1042938"></A>
Click OK to begin the restore operation.</Number>
</NumberList>
<EndList-root>
<A ID="pgfId-1047904"></A>
The Restores table lists when the restore was started, provides an estimate of the amount of time left, and lists other status information about the restore operation. When the restore is complete, the entry in the backup table disappears. </EndList-root>
<Body>
<A ID="pgfId-1042992"></A>
If the status for any of the forests was something besides 'completed,' then an error occurred during the restore operation. Check the <Emphasis>
Mark_Logic_Data</Emphasis>
<code>
/Logs/ErrorLog.txt</code>
 file for any errors, correct them, and try the restore operation again.</Body>
</XML>
