<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="session-login.css" type="text/css" charset="UTF-8"?>
<XML>
<TITLE> </TITLE><Heading-1>
<A ID="pgfId-1041811"></A>
<A ID="23690"></A>
Managing User Sessions and Monitoring Login Attempts</Heading-1>
<pagenum>
<A ID="pgfId-1041925"></A>
95</pagenum>
<Body>
<A ID="pgfId-1041815"></A>
MarkLogic Server provides facilities to control and manage user sessions and monitoring login attempts. This chapter describes how to use and mange these features and includes the following parts:</Body>
<Body-bullet>
<A ID="pgfId-1049578"></A>
<A href="session-login.xml#id(48668)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Managing Concurrent User Sessions</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1051671"></A>
<A href="session-login.xml#id(48386)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Setting Request Blackouts on an App Server</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1049582"></A>
<A href="session-login.xml#id(54951)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Storing and Monitoring the Last User Login Attempt</Hyperlink>
</A></Body-bullet>
<Heading-2>
<A ID="pgfId-1038444"></A>
<A ID="48668"></A>
Managing Concurrent User Sessions</Heading-2>
<Body>
<A ID="pgfId-1049961"></A>
MarkLogic Server allows you to limit the maximum number of concurrent user sessions against a given App Server. This section describes this feature and provides information on configuring the concurrent request limit, and includes the following parts:</Body>
<Body-bullet>
<A ID="pgfId-1050175"></A>
<A href="session-login.xml#id(52253)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Limiting Concurrent Requests with User Session Limits</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1050317"></A>
<A href="session-login.xml#id(81025)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Configuring User Concurrent Session Controls</Hyperlink>
</A></Body-bullet>
<Heading-3>
<A ID="pgfId-1049625"></A>
<A ID="52253"></A>
Limiting Concurrent Requests with User Session Limits</Heading-3>
<Body>
<A ID="pgfId-1050033"></A>
There is an option on each App Server (HTTP Server, XDBC Server, and WebDAV Server) configuration to limit the number of <Emphasis>
concurrent requests</Emphasis>
 a user can have against that App Server. A concurrent request is defined to be a request against that App Server from the same user while another request from the same user is still active. Each App Server has a <code>
concurrent&#160;request&#160;limit</code>
 configuration parameter. The default is 0, which means there is no limit to the number of concurrent requests. The value must be an integer greater than or equal to&#160;0.</Body>
<Body>
<A ID="pgfId-1050236"></A>
If you set the <code>
concurrent&#160;request&#160;limit</code>
 configuration parameter to a value other than 0, it limits the number of concurrent requests any user can run against that App Server to the specified number. For example, if you set the number to 3, then any requests made by a user named <code>
raymond</code>
 while 3 requests from <code>
raymond</code>
 are running will fail with an exception. </Body>
<Body>
<A ID="pgfId-1050267"></A>
When the limit is reached, the application will throw a 403 (forbidden) error with the <code>
XDMP-REQUESTLIMIT</code>
 exception.</Body>
<Heading-3>
<A ID="pgfId-1050032"></A>
<A ID="81025"></A>
Configuring User Concurrent Session Controls</Heading-3>
<Body>
<A ID="pgfId-1050225"></A>
To configure a user concurrent session limit, perform the following steps in the Admin Interface:</Body>
<Number1>
<A ID="pgfId-1050278"></A>
Click the Groups icon.</Number1>
<NumberList>
<Number>
<A ID="pgfId-1050288"></A>
Click the group in which the App Server you want to configure resides (for example, Default).</Number>
<Number>
<A ID="pgfId-1050290"></A>
Click the App Servers icon on the left tree menu.</Number>
<Number>
<A ID="pgfId-1050273"></A>
Select the App Server in which you want to configure concurrent session limits. The App Server Configuration page displays.</Number>
<Number>
<A ID="pgfId-1050293"></A>
In the <code>
concurrent request limit</code>
 field, enter a value corresponding to the maximum number of concurrent user sessions you want to allow. For example, if you want only 3 concurrent sessions, enter 3. A value of 0 means there is no concurrent request limit&#160;(unlimited).</Number>
<Number>
<A ID="pgfId-1050296"></A>
Click OK to save the configuration change.</Number>
</NumberList>
<EndList-root>
<A ID="pgfId-1050297"></A>
For new requests, the new <code>
concurrent request limit</code>
 will be enforced.</EndList-root>
<Heading-2>
<A ID="pgfId-1051616"></A>
<A ID="48386"></A>
Setting Request Blackouts on an App Server</Heading-2>
<Body>
<A ID="pgfId-1051620"></A>
MarkLogic Server allows you to manage when a user or group of users cannot run requests against an App Server. You can manage these blackout periods for each App Server by setting up one or more Request Blackouts for an App Server. Request blackouts can specify users, roles, and time periods for the blackouts, as well as specifying if it is a one-time blackout or a recurring blackout.</Body>
<Body-bullet>
<A ID="pgfId-1051624"></A>
<A href="session-login.xml#id(90562)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Configuring Request Blackouts</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1051628"></A>
<A href="session-login.xml#id(24621)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Deleting Request Blackouts</Hyperlink>
</A></Body-bullet>
<Heading-3>
<A ID="pgfId-1051630"></A>
<A ID="90562"></A>
Configuring Request Blackouts</Heading-3>
<Body>
<A ID="pgfId-1051631"></A>
Perform the following to configure request blackout periods:</Body>
<Number1>
<A ID="pgfId-1051632"></A>
In the Admin Interface tree menu, click the Groups &gt; <Emphasis>
group_name</Emphasis>
 &gt; App Servers &gt; <Emphasis>
app_server_name</Emphasis>
 link, where <Emphasis>
group_name</Emphasis>
 is the name of the group and <Emphasis>
app_server_name</Emphasis>
 is the name of the App Server in which you want to specify a request blackout period.</Number1>
<NumberList>
<Number>
<A ID="pgfId-1051633"></A>
Click the Request Blackout menu item under your App Server. The Request Blackout Policy Configuration page appears.</Number>
<Number>
<A ID="pgfId-1051634"></A>
Click the Create tab. The Add Request Blackout page appears.</Number>
<Number>
<A ID="pgfId-1051635"></A>
Fill in the form as needed for the blackout period you want to create. Clicking the radio buttons will bring up more forms to complete.</Number>
<Number>
<A ID="pgfId-1051636"></A>
Click OK to create the blackout period.</Number>
</NumberList>
<EndList-root>
<A ID="pgfId-1051637"></A>
The new blackout period will take effect immediately.</EndList-root>
<Heading-3>
<A ID="pgfId-1051639"></A>
<A ID="24621"></A>
Deleting Request Blackouts</Heading-3>
<Body>
<A ID="pgfId-1051640"></A>
Perform the following to delete a request blackout period:</Body>
<Number1>
<A ID="pgfId-1051641"></A>
In the Admin Interface tree menu, click the Groups &gt; <Emphasis>
group_name</Emphasis>
 &gt; App Servers &gt; <Emphasis>
app_server_name</Emphasis>
 link, where <Emphasis>
group_name</Emphasis>
 is the name of the group and <Emphasis>
app_server_name</Emphasis>
 is the name of the App Server in which you want to specify a request blackout period.</Number1>
<NumberList>
<Number>
<A ID="pgfId-1051642"></A>
Click the Request Blackout menu item under your App Server. The Request Blackout Policy Configuration page appears.</Number>
<Number>
<A ID="pgfId-1051643"></A>
In the area corresponding to the blackout period you want to delete, click the Delete button.</Number>
<Number>
<A ID="pgfId-1051644"></A>
Click OK on the confirmation page to delete the blackout period.</Number>
</NumberList>
<EndList-root>
<A ID="pgfId-1051645"></A>
The blackout period is deleted immediately.</EndList-root>
<Heading-2>
<A ID="pgfId-1049584"></A>
<A ID="54951"></A>
Storing and Monitoring the Last User Login Attempt</Heading-2>
<Body>
<A ID="pgfId-1049588"></A>
MarkLogic Server provides the ability to store the outcome of the last attempt a user made at logging in. This section describes this feature and how to use it, and contains the following parts:</Body>
<Body-bullet>
<A ID="pgfId-1050226"></A>
<A href="session-login.xml#id(47451)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Storing Last User Login Information in a Last-Login Database</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1050347"></A>
<A href="session-login.xml#id(68635)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Configuring User Login Monitoring</Hyperlink>
</A></Body-bullet>
<Body-bullet>
<A ID="pgfId-1050352"></A>
<A href="session-login.xml#id(60460)" xml:link="simple" show="replace" actuate="user" CLASS="XRef"><Hyperlink>
Displaying the Last Login Information for an App Server or for the Admin Interface</Hyperlink>
</A></Body-bullet>
<Heading-3>
<A ID="pgfId-1049629"></A>
<A ID="47451"></A>
Storing Last User Login Information in a Last-Login Database</Heading-3>
<Body>
<A ID="pgfId-1050207"></A>
A database named <code>
Last-Login</code>
 is created upon installation of (or upgrade from 3.2 to) MarkLogic Server. You can use this database as the last-login database for one or more App Servers. Each time a successful or unsuccessful login is made via the App Server, the last-login database is updated with that information. Only information for the last login attempt is retained. Because this database is constantly changing with each login attempt (every request is authenticated, so each request updates the last-login database), it is a good idea to use a different database than content database for your last-login database. In general, it is probably OK to keep a single last-login database that is shared by all App Servers who use this functionality, but if you do this, keep in mind that the information will then be shared by all the App Servers; that is, that the last-login time and other statistics will be for all App Servers using the last-login database.</Body>
<Note>
<A ID="pgfId-1050530"></A>
A history of the successful login attempts is not retained; only the time of the last successful login is stored in the database.</Note>
<Heading-3>
<A ID="pgfId-1050198"></A>
<A ID="68635"></A>
Configuring User Login Monitoring</Heading-3>
<Body>
<A ID="pgfId-1050208"></A>
Perform the following steps to set up user login monitoring for a given App Server.</Body>
<Number1>
<A ID="pgfId-1050380"></A>
Click the Groups icon.</Number1>
<NumberList>
<Number>
<A ID="pgfId-1050381"></A>
Click the group in which the App Server you want to configure resides (for example, Default).</Number>
<Number>
<A ID="pgfId-1050382"></A>
Click the App Servers icon on the left tree menu.</Number>
<Number>
<A ID="pgfId-1050383"></A>
Select the App Server in which you want to configure the last-login database. The App Server Configuration page displays.</Number>
<Number>
<A ID="pgfId-1050366"></A>
Select a database for the Last Login database. The <code>
Last-Login</code>
 database is created for this purpose, but you can select any database that you want. If no last-login database is selected, then the last-login feature is disabled.</Number>
<Number>
<A ID="pgfId-1050597"></A>
Optionally, select <code>
true</code>
 on the Display Last Login radio button. </Number>
<Number>
<A ID="pgfId-1050371"></A>
Click OK to save the changes.</Number>
</NumberList>
<Heading-3>
<A ID="pgfId-1050995"></A>
<A ID="60460"></A>
Displaying the Last Login Information for an App Server or for the Admin Interface</Heading-3>
<Body>
<A ID="pgfId-1050996"></A>
Each App Server configuration page has a <code>
display last login</code>
 setting. The value of this setting is returned as part of the XML output of the <code>
xdmp:user-last-login</code>
 API. You can use this information as logic in your application to determine whether to display some last-login information to the application.</Body>
<Body>
<A ID="pgfId-1050997"></A>
The Admin Interface uses the <code>
display last login</code>
 setting to show information about its last login attempt. When a last-login database is configured and the <code>
display last login</code>
 setting is true, then something similar to the following is displayed at the bottom of each page of the Admin Interface:</Body>
<Code>
<A ID="pgfId-1050998"></A>
last successful login: September 2, 2008 7:54:16 PM
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;last unsuccessful login: none
&#160;&#160;&#160;&#160;unsuccessful login attempts since last login: 0</Code>
</XML>
